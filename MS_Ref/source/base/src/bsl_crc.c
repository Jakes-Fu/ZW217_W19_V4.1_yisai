/******************************************************************************
 ** File Name:      bsl_crc.c                                                 *
 ** Author:         Haifeng.Yang                                              *
 ** DATE:           2010.08.02                                                *
 ** Copyright:      2010 Spreatrum, Incoporated. All Rights Reserved.         *
 ** Description:                                                              *
 **                                                                           *
 **                                                                           *
 ******************************************************************************

 ******************************************************************************
 **                               Edit History                                *
 ** ------------------------------------------------------------------------- *
 **     DATE          NAME             DESCRIPTION                            *
 **  2010.08.02   Haifeng.Yang          Create.                               *
 ******************************************************************************/

/**---------------------------------------------------------------------------*
 **                             Dependencies                                  *
 **---------------------------------------------------------------------------*/

/**---------------------------------------------------------------------------*
 **                            Compiler Flag                                  *
 **---------------------------------------------------------------------------*/
#ifdef __cplusplus
extern   "C" 
{
#endif
/**---------------------------------------------------------------------------*
 **                           Macros & Enums                                  *
 **---------------------------------------------------------------------------*/
#define CRC_16_POLYNOMIAL       0x1021
#define CRC_16_L_POLYNOMIAL     0x8000
#define CRC_16_L_SEED           0x80
#define CRC_16_L_OK             0x00
#define HDLC_FLAG               0x7E
#define HDLC_ESCAPE             0x7D
#define HDLC_ESCAPE_MASK        0x20
#define CRC_CHECK_SIZE          0x02
/**---------------------------------------------------------------------------*
 **                           Data Structures                                 *
 **---------------------------------------------------------------------------*/

/**---------------------------------------------------------------------------*
 **                      Global/Local Function Prototypes                     *
 **---------------------------------------------------------------------------*/

/**---------------------------------------------------------------------------*
 **                        Global/Local Variables                             *
 **---------------------------------------------------------------------------*/

/**---------------------------------------------------------------------------*
 **                        Function Definitions                               *
 **---------------------------------------------------------------------------*/

/******************************************************************************/
// Description: 
// Dependence: 
// Author:        
// Note:
/******************************************************************************/
unsigned int crc_16_l_calc(char* buf_ptr,unsigned int len)
{
    unsigned int i;
    unsigned short crc = 0;
    
    while (len--!=0)
    {
        for(i = CRC_16_L_SEED; i !=0 ; i = i>>1)
        {
           if((crc & CRC_16_L_POLYNOMIAL) !=0 )
           {
               crc = crc << 1 ;
               crc = crc ^ CRC_16_POLYNOMIAL;
           }
           else
           {
               crc = crc << 1 ;
           } 
        
           if(((unsigned char)*buf_ptr & i) != 0 )
           {
              crc = crc ^ CRC_16_POLYNOMIAL;
           }
        }
        buf_ptr++;
    }
    
    return (crc);
}

/**---------------------------------------------------------------------------*
 **                            Compiler Flag                                  *
 **---------------------------------------------------------------------------*/
#ifdef __cplusplus
}
#endif

/******************************************************************************/



