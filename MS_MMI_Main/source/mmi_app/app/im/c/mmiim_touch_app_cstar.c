/*==============================================================================
File Name: mmiim_touch_app_cstar.c
Author: Lianxiang.Zhou
Date: 2011/12/13
Copyright: 2011 Spreadtrum, Incorporated. All Rights Reserved.
Description:
--------------------------------------------------------------------------------
Edit History
--------------------------------------------------------------------------------
DATE         NAME            DESCRIPTION
2011/12/13   Lianxiang.Zhou  Create.
==============================================================================*/

/*------------------------------------------------------------------------------
Include files
------------------------------------------------------------------------------*/

#include "mmi_app_im_trc.h"
#ifdef WIN32
#pragma warning (disable:4244)
#pragma warning (disable:4127)
#pragma warning (disable:4761)
#endif

#include "mmiim_touch_ime_common.h"
#include "mmiim_touch_ime_cstar.h"
#include "mmiim_touch_ime_hw.h"
#include "mmiim_touch_set.h"

#define IM_MEM_OVERLAP_DEBUG    //now, IME has a memory overlap, but too difficult to debug, add this. yaoguang.chen@spread. 2013-01-14

#if defined(IM_ENGINE_CSTAR)  && defined (MMI_IM_PDA_SUPPORT)


/* 系统 */
LOCAL void* Initialize(GUIIM_INIT_KERNEL_T *param_ptr);
LOCAL BOOLEAN Terminate(void *handle);
LOCAL BOOLEAN HandleMsg(
    void *handle,
    GUIIM_EVENT_T event,
    GUIIM_EVENT_DATA_U *event_data_ptr
);

/* 系统辅助 */
LOCAL BOOLEAN HandleSysMsg(
    IM_DATA_T *data_ptr,
    GUIIM_EVENT_DATA_U const *event_data_ptr
);
LOCAL void ClearState(IM_DATA_T *data_ptr);
LOCAL BOOLEAN ClearTimer(IM_DATA_T *data_ptr);
LOCAL void TermImm(IM_DATA_T *data_ptr);
LOCAL BOOLEAN SetMethod(
    IM_DATA_T *data_ptr,
    GUIIM_METHOD_T method
);

LOCAL void ResetKernel(IM_DATA_T *data_ptr);
LOCAL BOOLEAN IsInputting(IM_DATA_T *data_ptr);


GUIIM_KERNEL_APIS_T const g_guiim_touch_apis =
{
    Initialize,
    Terminate,
    HandleMsg,
};

static CAF_HANDLE_T s_last_ctrl_handle = 0;



/////====将部分暂不支持的智能输入和手写都用"//"给屏蔽掉了 111121
static SETTING_MENU_DATA_T const s_setting_menu_data[] =
{
#if defined (IM_SIMP_CHINESE_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    {
        GUIIM_LANG_CHS, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_PINYIN
    },
    {GUIIM_LANG_CHS, GUIIM_TYPE_STROKE, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_STROKE},
#endif    
#if defined(IM_HANDWRITING_HANWANG)
    {GUIIM_LANG_CHS, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW},
#endif
#endif

#if defined (IM_TRAD_CHINESE_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    {
        GUIIM_LANG_CHT, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_ZHUYIN
    },
    {GUIIM_LANG_CHT, GUIIM_TYPE_STROKE, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_STROKE},
#endif    
#if defined(IM_HANDWRITING_HANWANG)
    {GUIIM_LANG_CHT, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW},
#endif
#endif

#if defined (IM_RUSSIAN_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    {
        GUIIM_LANG_RUSSIAN, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_RUSSIAN_LEAD_UPPER
    },
    {
        GUIIM_LANG_RUSSIAN, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_RUSSIAN_ABC_LEAD_UPPER
    },
#endif
#if defined(IM_HANDWRITING_HANWANG)
    {
        GUIIM_LANG_RUSSIAN, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    },
#endif
#endif

#if defined (IM_ARABIC_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    {
        GUIIM_LANG_ARABIC, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_ARABIC
    },
    {
        GUIIM_LANG_ARABIC, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_ARABIC_ABC
    },
#endif    
#if defined(IM_HANDWRITING_HANWANG)
    {
        GUIIM_LANG_ARABIC, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    },
#endif
#endif

#if defined (IM_ASSAMESE_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    //{
    //GUIIM_LANG_ASSAMESE, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_ASSAMESE
    //},
    {
        GUIIM_LANG_ASSAMESE, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_ASSAMESE_ABC
    },
#endif    
    //{
    //GUIIM_LANG_ASSAMESE, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    //},
#endif

#if defined (IM_BENGALI_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    {
        GUIIM_LANG_BENGALI, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_BENGALI
    },
    {
        GUIIM_LANG_BENGALI, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_BENGALI_ABC
    },
#endif
#if defined(IM_HANDWRITING_HANWANG)
    {
        GUIIM_LANG_BENGALI, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    },
#endif
#endif

#if defined (IM_GEORGIAN_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    //{
    //GUIIM_LANG_GEORGIAN, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_GEORGIAN
    //},
    {
        GUIIM_LANG_GEORGIAN, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_GEORGIAN_ABC
    },
#endif    
    //{
    //GUIIM_LANG_GEORGIAN, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    //},
#endif

#if defined (IM_GUJARATI_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    //{
    //GUIIM_LANG_GUJARATI, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_GUJARATI
    //},
    {
        GUIIM_LANG_GUJARATI, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_GUJARATI_ABC
    },
#endif    
    //{
    //GUIIM_LANG_GUJARATI, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    //},
#endif

#if defined (IM_HEBREW_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    {
        GUIIM_LANG_HEBREW, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_HEBREW
    },
    {
        GUIIM_LANG_HEBREW, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_HEBREW_ABC
    },
#endif    
#if defined(IM_HANDWRITING_HANWANG)
    {
        GUIIM_LANG_HEBREW, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    },
#endif
#endif

#if defined (IM_HINDI_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    {
        GUIIM_LANG_HINDI, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_HINDI
    },
    {
        GUIIM_LANG_HINDI, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_HINDI_ABC
    },
#endif    
#if defined(IM_HANDWRITING_HANWANG)
    {
        GUIIM_LANG_HINDI, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    },
#endif
#endif

#if defined (IM_KANNADA_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    //{
    //GUIIM_LANG_KANNADA, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_KANNADA
    //},
    {
        GUIIM_LANG_KANNADA, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_KANNADA_ABC
    },
#endif    
    //{
    //GUIIM_LANG_KANNADA, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    //},
#endif

#if defined (IM_MALAYALAM_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    //{
    //GUIIM_LANG_MALAYALAM, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_MALAYALAM
    //},
    {
        GUIIM_LANG_MALAYALAM, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_MALAYALAM_ABC
    },
#endif
    //{
    //GUIIM_LANG_MALAYALAM, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    //},
#endif

//MYANMAR 缅甸
#if defined (IM_MYANMAR_SUPPORT)
    {
        GUIIM_LANG_MYANMAR, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_MYANMAR
    },
#endif

#if defined (IM_MARATHI_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    //{
    //GUIIM_LANG_MARATHI, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_MARATHI
    //},
    {
        GUIIM_LANG_MARATHI, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_MARATHI_ABC
    },
#endif
    //{
    //GUIIM_LANG_MARATHI, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    //},
#endif

#if defined (IM_ORIYA_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    //{
    //GUIIM_LANG_ORIYA, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_ORIYA
    //},
    {
        GUIIM_LANG_ORIYA, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_ORIYA_ABC
    },
#endif
    //{
    //GUIIM_LANG_ORIYA, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    //},
#endif

#if defined (IM_PERSIAN_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    {
        GUIIM_LANG_PERSIAN, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_PERSIAN
    },
    {
        GUIIM_LANG_PERSIAN, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_PERSIAN_ABC
    },
#endif    
#if defined(IM_HANDWRITING_HANWANG)
    {
        GUIIM_LANG_PERSIAN, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    },
#endif
#endif

#if defined (IM_PUNJABI_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    //{
    //GUIIM_LANG_PUNJABI, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_PUNJABI
    //},
    {
        GUIIM_LANG_PUNJABI, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_PUNJABI_ABC
    },
#endif    
    //{
    //GUIIM_LANG_PUNJABI, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    //},
#endif

#if defined (IM_TAGALOG_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    //{
    //GUIIM_LANG_TAGALOG, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_TAGALOG
    //},
    {
        GUIIM_LANG_TAGALOG, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_TAGALOG_ABC
    },
#endif    
#if defined(IM_HANDWRITING_HANWANG)
    {
        GUIIM_LANG_TAGALOG, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    },
#endif
#endif

#if defined (IM_TAMIL_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    //{
    //GUIIM_LANG_TAMIL, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_TAMIL
    //},
    {
        GUIIM_LANG_TAMIL, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_TAMIL_ABC
    },
#endif    
    //{
    //GUIIM_LANG_TAMIL, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    //},
#endif

#if defined (IM_TELUGU_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    //{
    //GUIIM_LANG_TELUGU, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_TELUGU
    //},
    {
        GUIIM_LANG_TELUGU, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_TELUGU_ABC
    },
#endif    
    //{
    //GUIIM_LANG_TELUGU, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    //},
#endif

#if defined (IM_THAI_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    {
        GUIIM_LANG_THAI, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_THAI
    },
    {
        GUIIM_LANG_THAI, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_THAI_ABC
    },
#endif    
#if defined(IM_HANDWRITING_HANWANG)
    {
        GUIIM_LANG_THAI, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    },
#endif
#endif

#if defined (IM_URDU_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    {
        GUIIM_LANG_URDU, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_URDU
    },
    {
        GUIIM_LANG_URDU, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_URDU_ABC
    },
#endif    
#if defined(IM_HANDWRITING_HANWANG)
    {
        GUIIM_LANG_URDU, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    },
#endif
#endif

#if defined (IM_AFRIKAANS_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    //{
    //GUIIM_LANG_AFRIKAANS, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_AFRIKAANS
    //},
    {
        GUIIM_LANG_AFRIKAANS, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_AFRIKAANS_ABC_LEAD_UPPER
    },
#endif    
    //{
    //GUIIM_LANG_AFRIKAANS, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    //},
#endif

#if defined (IM_ALBANIAN_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    //{
    //GUIIM_LANG_ALBANIAN, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_ALBANIAN
    //},
    {
        GUIIM_LANG_ALBANIAN, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_ALBANIAN_ABC_LEAD_UPPER
    },
#endif    
    //{
    //GUIIM_LANG_ALBANIAN, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    //},
#endif

#if defined (IM_ARMENIAN_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    {
        GUIIM_LANG_ARMENIAN, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_ARMENIAN
    },
    {
         GUIIM_LANG_ARMENIAN, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_ARMENIAN_ABC_LEAD_UPPER
    },
#endif    
    //{
    //GUIIM_LANG_ARMENIAN, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    //},
#endif

#if defined (IM_AZERBAIJANI_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    //{
    //GUIIM_LANG_AZERBAIJANI, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_AZERBAIJANI
    //},
    {
        GUIIM_LANG_AZERBAIJANI, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_AZERBAIJANI_ABC_LEAD_UPPER
    },
#endif    
    //{
    //GUIIM_LANG_AZERBAIJANI, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    //},
#endif

#if defined (IM_BASQUE_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    //{
    //GUIIM_LANG_BASQUE, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_BASQUE
    //},
    {
        GUIIM_LANG_BASQUE, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_BASQUE_ABC_LEAD_UPPER
    },
#endif    
    //{
    //GUIIM_LANG_BASQUE, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    //},
#endif

#if defined (IM_BULGARIAN_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    {
        GUIIM_LANG_BULGARIAN, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_BULGARIAN
    },
    {
        GUIIM_LANG_BULGARIAN, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_BULGARIAN_ABC_LEAD_UPPER
    },
#endif    
#if defined(IM_HANDWRITING_HANWANG)
    {
        GUIIM_LANG_BULGARIAN, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    },
#endif
#endif

#if defined (IM_CATALAN_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    //{
    //GUIIM_LANG_CATALAN, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_CATALAN
    //},
    {
        GUIIM_LANG_CATALAN, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_CATALAN_ABC_LEAD_UPPER
    },
#endif    
    //{
    //GUIIM_LANG_CATALAN, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    //},
#endif

#if defined (IM_CROATIAN_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    //{
    //GUIIM_LANG_CROATIAN, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_CROATIAN
    //},
    {
        GUIIM_LANG_CROATIAN, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_CROATIAN_ABC_LEAD_UPPER
    },
#endif    
#if defined(IM_HANDWRITING_HANWANG)
    {
        GUIIM_LANG_CROATIAN, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    },
#endif
#endif

#if defined (IM_CZECH_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    {
        GUIIM_LANG_CZECH, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_CZECH
    },
    {
        GUIIM_LANG_CZECH, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_CZECH_ABC_LEAD_UPPER
    },
#endif    
#if defined(IM_HANDWRITING_HANWANG)
    {
        GUIIM_LANG_CZECH, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    },
#endif
#endif

#if defined (IM_DANISH_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    {
        GUIIM_LANG_DANISH, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_DANISH
    },
    {
        GUIIM_LANG_DANISH, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_DANISH_ABC_LEAD_UPPER
    },
#endif    
#if defined(IM_HANDWRITING_HANWANG)
    {
        GUIIM_LANG_DANISH, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    },
#endif
#endif

#if defined (IM_DUTCH_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    {
        GUIIM_LANG_DUTCH, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_DUTCH
    },
    {
        GUIIM_LANG_DUTCH, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_DUTCH_ABC_LEAD_UPPER
    },
#endif    
#if defined(IM_HANDWRITING_HANWANG)
    {
        GUIIM_LANG_DUTCH, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    },
#endif
#endif

#if defined (IM_ESTONIAN_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    //{
    //GUIIM_LANG_ESTONIAN, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_ESTONIAN
    //},
    {
        GUIIM_LANG_ESTONIAN, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_ESTONIAN_ABC_LEAD_UPPER
    },
#endif    
    //{
    //GUIIM_LANG_ESTONIAN, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    //},
#endif

#if defined (IM_FILIPINO_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    //{
    //GUIIM_LANG_FILIPINO, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_FILIPINO
    //},
    {
        GUIIM_LANG_FILIPINO, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_FILIPINO_ABC_LEAD_UPPER
    },
#endif    
    //{
    //GUIIM_LANG_FILIPINO, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    //},
#endif

#if defined (IM_FINNISH_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    {
        GUIIM_LANG_FINNISH, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_FINNISH
    },
    {
        GUIIM_LANG_FINNISH, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_FINNISH_ABC_LEAD_UPPER
    },
#endif    
#if defined(IM_HANDWRITING_HANWANG)
    {
        GUIIM_LANG_FINNISH, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    },
#endif
#endif

#if defined (IM_FRENCH_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    {
        GUIIM_LANG_FRENCH, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_FRENCH
    },
    {
        GUIIM_LANG_FRENCH, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_FRENCH_ABC_LEAD_UPPER
    },
#endif    
#if defined(IM_HANDWRITING_HANWANG)
    {
        GUIIM_LANG_FRENCH, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    },
#endif
#endif

#if defined (IM_GALICIAN_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    //{
    //GUIIM_LANG_GALICIAN, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_GALICIAN
    //},
    {
        GUIIM_LANG_GALICIAN, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_GALICIAN_ABC_LEAD_UPPER
    },
#endif    
    //{
    //GUIIM_LANG_GALICIAN, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    //},
#endif

#if defined (IM_GERMAN_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    {
        GUIIM_LANG_GERMAN, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_GERMAN
    },
    {
        GUIIM_LANG_GERMAN, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_GERMAN_ABC_LEAD_UPPER
    },
#endif    
#if defined(IM_HANDWRITING_HANWANG)
    {
        GUIIM_LANG_GERMAN, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    },
#endif
#endif

#if defined (IM_GREEK_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    {
        GUIIM_LANG_GREEK, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_GREEK
    },
    {
        GUIIM_LANG_GREEK, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_GREEK_ABC_LEAD_UPPER
    },
#endif    
#if defined(IM_HANDWRITING_HANWANG)
    {
        GUIIM_LANG_GREEK, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    },
#endif
#endif

#if defined (IM_HAUSA_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    //{
    //GUIIM_LANG_HAUSA, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_HAUSA
    //},
    {
        GUIIM_LANG_HAUSA, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_HAUSA_ABC_LEAD_UPPER
    },
#endif    
    //{
    //GUIIM_LANG_HAUSA, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    //},
#endif

#if defined (IM_HUNGARIAN_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    {
        GUIIM_LANG_HUNGARIAN, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_HUNGARIAN
    },
    {
        GUIIM_LANG_HUNGARIAN, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_HUNGARIAN_ABC_LEAD_UPPER
    },
#endif    
#if defined(IM_HANDWRITING_HANWANG)
    {
        GUIIM_LANG_HUNGARIAN, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    },
#endif
#endif

#if defined (IM_ICELANDIC_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    //{
    //GUIIM_LANG_ICELANDIC, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_ICELANDIC
    //},
    {
        GUIIM_LANG_ICELANDIC, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_ICELANDIC_ABC_LEAD_UPPER
    },
#endif    
    //{
    //GUIIM_LANG_ICELANDIC, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    //},
#endif

#if defined (IM_IGBO_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    //{
    //GUIIM_LANG_IGBO, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_IGBO
    //},
    {
        GUIIM_LANG_IGBO, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_IGBO_ABC_LEAD_UPPER
    },
#endif    
    //{
    //GUIIM_LANG_IGBO, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    //},
#endif

#if defined (IM_INDONESIAN_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    {
        GUIIM_LANG_INDONESIAN, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_INDONESIAN
    },
    {
        GUIIM_LANG_INDONESIAN, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_INDONESIAN_ABC_UPPER
    },
#endif    
#if defined(IM_HANDWRITING_HANWANG)
    {
        GUIIM_LANG_INDONESIAN, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    },
#endif
#endif

#if defined (IM_IRISH_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    //{
    //GUIIM_LANG_IRISH, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_IRISH
    //},
    {
        GUIIM_LANG_IRISH, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_IRISH_ABC_LEAD_UPPER
    },
#endif    
    //{
    //GUIIM_LANG_IRISH, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    //},
#endif

#if defined (IM_ITALIAN_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    {
        GUIIM_LANG_ITALIAN, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_ITALIAN
    },
    {
        GUIIM_LANG_ITALIAN, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_ITALIAN_ABC_UPPER
    },
#endif    
#if defined(IM_HANDWRITING_HANWANG)
    {
        GUIIM_LANG_ITALIAN, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    },
#endif
#endif

#if defined (IM_KAZAKH_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    //{
    //GUIIM_LANG_KAZAKH, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_KAZAKH
    //},
    {
        GUIIM_LANG_KAZAKH, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_KAZAKH_ABC_LEAD_UPPER
    },
#endif    
    //{
    //GUIIM_LANG_KAZAKH, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    //},
#endif

#if defined (IM_LATVIAN_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    //{
    //GUIIM_LANG_LATVIAN, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_LATVIAN
    //},
    {
        GUIIM_LANG_LATVIAN, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_LATVIAN_ABC_LEAD_UPPER
    },
#endif    
    //{
    //GUIIM_LANG_LATVIAN, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    //},
#endif

#if defined (IM_LITHUANIAN_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    {
        GUIIM_LANG_LITHUANIAN, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_LITHUANIAN
    },
    {
        GUIIM_LANG_LITHUANIAN, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_LITHUANIAN_ABC_LEAD_UPPER
    },
#endif    
#if defined(IM_HANDWRITING_HANWANG)
    {
        GUIIM_LANG_LITHUANIAN, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    },
#endif
#endif

#if defined (IM_MACEDONIAN_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    //{
    //GUIIM_LANG_MACEDONIAN, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_MACEDONIAN
    //},
    {
        GUIIM_LANG_MACEDONIAN, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_MACEDONIAN_ABC_LEAD_UPPER
    },
#endif    
    //{
    //GUIIM_LANG_MACEDONIAN, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    //},
#endif

#if defined (IM_MALAY_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    {
        GUIIM_LANG_MALAY, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_MALAY
    },
    {
        GUIIM_LANG_MALAY, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_MALAY_ABC_LEAD_UPPER
    },
#endif    
#if defined(IM_HANDWRITING_HANWANG)
    {
        GUIIM_LANG_MALAY, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    },
#endif
#endif

#if defined (IM_MOLDOVAN_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    //{
    //GUIIM_LANG_MOLDOVAN, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_MOLDOVAN
    //},
    {
        GUIIM_LANG_MOLDOVAN, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_MOLDOVAN_ABC_LEAD_UPPER
    },
#endif    
    //{
    //GUIIM_LANG_MOLDOVAN, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    //},
#endif

#if defined (IM_NORWEGIAN_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    {
        GUIIM_LANG_NORWEGIAN, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_NORWEGIAN
    },
    {
        GUIIM_LANG_NORWEGIAN, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_NORWEGIAN_ABC_LEAD_UPPER
    },
#endif    
#if defined(IM_HANDWRITING_HANWANG)
    {
        GUIIM_LANG_NORWEGIAN, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    },
#endif
#endif

#if defined (IM_POLISH_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    {
        GUIIM_LANG_POLISH, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_POLISH
    },
    {
        GUIIM_LANG_POLISH, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_POLISH_ABC_LEAD_UPPER
    },
#endif    
#if defined(IM_HANDWRITING_HANWANG)
    {
        GUIIM_LANG_POLISH, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    },
#endif
#endif

#if defined (IM_PORTUGUESE_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    {
        GUIIM_LANG_PORTUGUESE, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_PORTUGUESE
    },
    {
        GUIIM_LANG_PORTUGUESE, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_PORTUGUESE_ABC_LEAD_UPPER
    },
#endif    
#if defined(IM_HANDWRITING_HANWANG)
    {
        GUIIM_LANG_PORTUGUESE, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    },
#endif
#endif

#if defined (IM_ROMANIAN_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    {
        GUIIM_LANG_ROMANIAN, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_ROMANIAN
    },
    {
        GUIIM_LANG_ROMANIAN, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_ROMANIAN_ABC_LEAD_UPPER
    },
#endif    
#if defined(IM_HANDWRITING_HANWANG)
    {
        GUIIM_LANG_ROMANIAN, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    },
#endif
#endif

#if defined (IM_SERBIAN_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    //{
    //GUIIM_LANG_SERBIAN, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_SERBIAN
    //},
    {
        GUIIM_LANG_SERBIAN, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_SERBIAN_ABC_LEAD_UPPER
    },
#endif    
    //{
    //GUIIM_LANG_SERBIAN, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    //},
#endif

#if defined (IM_SESOTHO_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    //{
    //GUIIM_LANG_SESOTHO, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_SESOTHO
    //},
    {
        GUIIM_LANG_SESOTHO, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_SESOTHO_ABC_LEAD_UPPER
    },
#endif    
    //{
    //GUIIM_LANG_SESOTHO, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    //},
#endif

#if defined (IM_SLOVAK_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    {
        GUIIM_LANG_SLOVAK, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_SLOVAK
    },
    {
        GUIIM_LANG_SLOVAK, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_SLOVAK_ABC_LEAD_UPPER
    },
#endif    
#if defined(IM_HANDWRITING_HANWANG)
    {
        GUIIM_LANG_SLOVAK, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    },
#endif
#endif

#if defined (IM_SLOVENIAN_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    {
        GUIIM_LANG_SLOVENIAN, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_SLOVENIAN
    },
    {
        GUIIM_LANG_SLOVENIAN, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_SLOVENIAN_ABC_LEAD_UPPER
    },
#endif    
#if defined(IM_HANDWRITING_HANWANG)
    {
        GUIIM_LANG_SLOVENIAN, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    },
#endif
#endif

#if defined (IM_SPANISH_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    {
        GUIIM_LANG_SPANISH, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_SPANISH
    },
    {
        GUIIM_LANG_SPANISH, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_SPANISH_ABC_LEAD_UPPER
    },
#endif    
#if defined(IM_HANDWRITING_HANWANG)
    {
        GUIIM_LANG_SPANISH, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    },
#endif
#endif

#if defined (IM_SWAHILI_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    //{
        //GUIIM_LANG_SWAHILI, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_SWAHILI
    //},
    {
        GUIIM_LANG_SWAHILI, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_SWAHILI_ABC_LEAD_UPPER
    },
#endif    
#if defined(IM_HANDWRITING_HANWANG)
    //{
        //GUIIM_LANG_SWAHILI, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    //},
#endif
#endif

#if defined (IM_SWEDISH_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    {
        GUIIM_LANG_SWEDISH, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_SWEDISH
    },
    {
        GUIIM_LANG_SWEDISH, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_SWEDISH_ABC_LEAD_UPPER
    },
#endif    
#if defined(IM_HANDWRITING_HANWANG)
    {
        GUIIM_LANG_SWEDISH, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    },
#endif
#endif

#if defined (IM_TURKISH_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    {
        GUIIM_LANG_TURKISH, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_TURKISH
    },
    {
        GUIIM_LANG_TURKISH, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_TURKISH_ABC_LEAD_UPPER
    },
#endif    
#if defined(IM_HANDWRITING_HANWANG)
    {
        GUIIM_LANG_TURKISH, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    },
#endif
#endif

#if defined (IM_UKRAINIAN_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    {
        GUIIM_LANG_UKRAINIAN, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_UKRAINIAN
    },
    {
        GUIIM_LANG_UKRAINIAN, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_UKRAINIAN_ABC_LEAD_UPPER
    },
#endif    
#if defined(IM_HANDWRITING_HANWANG)
    {
        GUIIM_LANG_UKRAINIAN, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    },
#endif
#endif

#if defined (IM_VIETNAMESE_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    {
        GUIIM_LANG_VIETNAMESE, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_VIETNAMESE
    },
    {
        GUIIM_LANG_VIETNAMESE, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_VIETNAMESE_ABC_LEAD_UPPER
    },
#endif    
#if defined(IM_HANDWRITING_HANWANG)
    {
        GUIIM_LANG_VIETNAMESE, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    },
#endif
#endif

#if defined (IM_XHOSA_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    //{
    //GUIIM_LANG_XHOSA, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_XHOSA
    //},
    {
        GUIIM_LANG_XHOSA, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_XHOSA_ABC_LEAD_UPPER
    },
#endif    
//#if defined(IM_HANDWRITING_HANWANG)    
    //{
    //GUIIM_LANG_XHOSA, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    //},
//#endif   
#endif

#if defined (IM_YORUBA_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    //{
    //GUIIM_LANG_YORUBA, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_YORUBA
    //},
    {
        GUIIM_LANG_YORUBA, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_YORUBA_ABC_LEAD_UPPER
    },
#endif    
//#if defined(IM_HANDWRITING_HANWANG)    
    //{
    //GUIIM_LANG_YORUBA, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    //},
//#endif    
#endif

#if defined (IM_ZULU_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    //{
    //GUIIM_LANG_ZULU, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_ZULU
    //},
    {
        GUIIM_LANG_ZULU, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_ZULU_ABC_LEAD_UPPER
    },
#endif    
//#if defined(IM_HANDWRITING_HANWANG)    
    //{
    //GUIIM_LANG_ZULU, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    //},
//#endif    
#endif

#if defined (IM_AMHARIC_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    //{
        //GUIIM_LANG_AMHARIC, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_AMHARIC
    //},
    {
        GUIIM_LANG_AMHARIC, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_AMHARIC_ABC
    },
#endif    
//#if defined(IM_HANDWRITING_HANWANG)    
    //{
        //GUIIM_LANG_AMHARIC, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    //},
//#endif    
#endif

#if defined (IM_KHMER_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    //{
        //GUIIM_LANG_KHMER, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_KHMER
    //},
    {
        GUIIM_LANG_KHMER, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_KHMER_ABC
    },
#endif    
//#if defined(IM_HANDWRITING_HANWANG)     
    //{
        //GUIIM_LANG_KHMER, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    //},
//#endif    
#endif

#if defined (IM_LAO_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    //{
        //GUIIM_LANG_LAO, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_LAO
    //},
    {
        GUIIM_LANG_LAO, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_LAO_ABC
    },
#endif    
//#if defined(IM_HANDWRITING_HANWANG)     
    //{
        //GUIIM_LANG_LAO, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
    //},
//#endif    
#endif

#if defined (IM_UYGHUR_SUPPORT)
#if (defined MMIIM_VKB_SUPPORT)
    {
        GUIIM_LANG_UYGHUR, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_INPUT_LANGUAGE_UYGHUR
    },
    {
        GUIIM_LANG_UYGHUR, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_UYGHUR_ABC
    },
#endif    
//#if defined(IM_HANDWRITING_HANWANG)
//    {
//        GUIIM_LANG_UYGHUR, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
//    },
//#endif
#endif

#if defined(IM_TIBETAN_SUPPORT)  
#if (defined MMIIM_VKB_SUPPORT)
	//{
	//	GUIIM_LANG_TIBETAN, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_TIBETAN,
	//},
	{
		GUIIM_LANG_TIBETAN, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_TIBETAN_ABC,
	},
#endif
//#if defined(IM_HANDWRITING_HANWANG)
//    {
//        GUIIM_LANG_TIBETAN, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW
//    },
//#endif
#endif

#if (defined MMIIM_VKB_SUPPORT)
    {GUIIM_LANG_ENGLISH, GUIIM_TYPE_SMART, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_ENGLISH_LOWER},
    {GUIIM_LANG_ENGLISH, GUIIM_TYPE_MULTITAP, GUIIM_INPUT_TYPE_NONE, IM_TXT_IM_SHORT_ABC_LOWER},
#endif
#if defined(IM_HANDWRITING_HANWANG)
    {
        GUIIM_LANG_ENGLISH, GUIIM_TYPE_NONE, GUIIM_INPUT_TYPE_HANDWRITING, IM_TXT_IM_SHORT_HW      //英文手写，动态配置
    },
#endif
    {0, 0, 0, TXT_COMN_MORE},
};






/*==============================================================================
Description: Initialize
Global resource dependence: NONE
Author: Lianxiang.Zhou
Note:
==============================================================================*/
LOCAL void* Initialize(GUIIM_INIT_KERNEL_T *param_ptr)
{
    IM_DATA_T *data_ptr = PNULL;
    BOOLEAN is_method_set = FALSE;
    
    SCI_TRACE_LOW("[MMIIM] [cstar] TP Initialize: param_ptr=%08X", param_ptr);
    
    //<-- 系统信息检查
    //1 必须支持多层
    if (!UILAYER_IsMultiLayerEnable())
    {
        SCI_TRACE_LOW("[MMIIM] TP Initialize: enable multilayer.");
        return PNULL;
    }

    //-->

    if (PNULL == param_ptr)
    {
        return PNULL;
    }

    data_ptr = (IM_DATA_T*)SCI_ALLOC_APP(sizeof(IM_DATA_T));
    SCI_MEMSET(data_ptr, 0, sizeof(IM_DATA_T));

    //data
    data_ptr->check_info = sizeof(IM_DATA_T);
    data_ptr->ctrl_handle = param_ptr->im_handle;
    data_ptr->init_param = *param_ptr;

    data_ptr->ui_layer.block_id = UILAYER_NULL_HANDLE;
    data_ptr->tip_layer.block_id = UILAYER_NULL_HANDLE;
    data_ptr->edit_layer.block_id = UILAYER_NULL_HANDLE;

    //SCI_ASSERT(PNULL != data_ptr->init_param.method_param_ptr); /*assert verified*/
    //SCI_ASSERT(PNULL != data_ptr->init_param.method_param_ptr->im_def_ptr); /*assert verified*/
    if(PNULL == data_ptr->init_param.method_param_ptr || PNULL == data_ptr->init_param.method_param_ptr->im_def_ptr)
    {
        SCI_TRACE_LOW("[MMIIM] TP Initialize: method_param_ptr is null.");
        return  PNULL;
    }
    
    data_ptr->f_term_imm = TermImm;
    data_ptr->f_set_method = SetMethod;
    data_ptr->f_is_inputting = IsInputting;
    data_ptr->f_draw_all = MMIIM_DrawAll;

    data_ptr->setting_menu_data = s_setting_menu_data;
    data_ptr->setting_menu_size = ARR_SIZE(s_setting_menu_data);

    data_ptr->kb_size = MMIIM_GetKeyboardSize();
    SetPanel(data_ptr);

    is_method_set = SetMethod(data_ptr, data_ptr->init_param.method_param_ptr->im_def_ptr->method);

    //SCI_ASSERT(is_method_set); /*assert verified*/
    if(!is_method_set)
    {
        SCI_TRACE_LOW("[MMIIM] TP Initialize: is_method_set false.");
        return  PNULL;
    }
    //out effect 总是激活的，中途可关闭
    data_ptr->is_out_effect_enabled = FALSE;

    //如果启动输入法的控件handle还是上一个，则关闭in effect
    if (param_ptr->im_handle != s_last_ctrl_handle)
    {
        s_last_ctrl_handle = param_ptr->im_handle;
        //data_ptr->is_in_effect_enabled = TRUE;    //NEWMS00201394 【6530  量产客户】新建分组编辑分组名称时编辑名称框反应有迟钝
    }

    return data_ptr;
}


/*==============================================================================
Description: Terminate
Global resource dependence: NONE
Author: Lianxiang.Zhou
Note:
==============================================================================*/
LOCAL BOOLEAN Terminate(void *handle)
{
    IM_DATA_T *data_ptr = (IM_DATA_T *)handle;

    CHECK_DATA_EX(data_ptr);
    
    SCI_TRACE_LOW("[MMIIM] TP Terminate: handle=%08X, method=%04X, lang=%d, \
        data=%08X, vkb=%08X", handle, 
        data_ptr->init_param.method_param_ptr->im_def_ptr->method,
        data_ptr->init_param.method_param_ptr->im_def_ptr->lang,
        data_ptr->data, &(data_ptr->vkb));

    //check input lang and reset it if need...
    if (MMIAPIIM_GetLanguage() != data_ptr->init_param.method_param_ptr->im_def_ptr->lang
            && GUIIM_LANG_NONE != data_ptr->init_param.method_param_ptr->im_def_ptr->lang)
    {
        MMIAPIIM_SetLanguage(data_ptr->init_param.method_param_ptr->im_def_ptr->lang);
    }

    TermImm(data_ptr);

    ReleaseUILayer(data_ptr);
    ReleaseTipLayer(data_ptr);
    ReleaseEditLayer(data_ptr);

    SCI_FREEIF(data_ptr);

    return TRUE;
}


/*==============================================================================
Description: HandleMsg
Global resource dependence: NONE
Author: Lianxiang.Zhou
Note:
==============================================================================*/
LOCAL BOOLEAN HandleMsg(
    void *handle,
    GUIIM_EVENT_T event,
    GUIIM_EVENT_DATA_U *event_data_ptr
)
{
    IM_DATA_T *data_ptr = (IM_DATA_T *)handle;
    BOOLEAN result = FALSE;
	uint32 time_begin = SCI_GetTickCount();

 #if defined IM_MEM_OVERLAP_DEBUG
    MMK_CheckAllocatedMemInfo( _D_FILE_NAME, _D_FILE_LINE );
#endif

   CHECK_DATA(data_ptr);

    switch (event)
    {
    case GUIIM_EVENT_SYS_MSG:
        result = HandleSysMsg(data_ptr, event_data_ptr);
        break;

    case GUIIM_EVENT_PAINT:
        //针对部分模块，比如pubwin的蒙板问题，总是在full paint的时候将层移出来
        UILAYER_RemoveBltLayer(&data_ptr->ui_layer);
        result = MMIIM_DrawAll(data_ptr);
        break;

    case GUIIM_EVENT_SET_METHOD:
        TermImm(data_ptr);
        result = SetMethod(data_ptr, event_data_ptr->set_method);
        break;

    case GUIIM_EVENT_GET_METHOD:
        break;

    case GUIIM_EVENT_SLEEP:
    case GUIIM_EVENT_FORCE_COMMIT:
        //如果是强制提交的话，下面会把首字母大写的定时器停掉，导致无法自动
        //从首字大写切换到小写的功能
        if (CAPITTAL_MODE_INITIAL == data_ptr->vkb.cap
            && (data_ptr->multi_tap_data.commit_timer > 0))
        {
            SetVkbCaps(data_ptr, CAPITTAL_MODE_LOWER);
        }
        ClearState(data_ptr);
        MMIIM_DrawAll(data_ptr);
        break;

    case GUIIM_EVENT_GET_CTRL_RECT:
        event_data_ptr->get_ctrl_rect = data_ptr->rect;
        result = TRUE;
        break;

    case GUIIM_EVENT_GET_RECT:
#if defined MMIIM_HW_FULLSCREEN_SUPPORT
        if (!data_ptr->is_symbol_panel
            && data_ptr->init_param.method_param_ptr->im_def_ptr->method == GUIIM_M_HANDWRITING
            ) //从手写切换到sym后，上述的输入法值依然为hw
        {
            HwFullScreenGetDisplayPanelRect (data_ptr, &event_data_ptr->get_rect);
            result = TRUE;
            break;
        }
#endif

        event_data_ptr->get_rect = data_ptr->rect;
        result = TRUE;
        break;

    case GUIIM_EVENT_GET_EDIT_STATE:
        break;

    case GUIIM_EVENT_CUSTOM_KEY:
        break;

    default:
        break;
    }

#if defined IM_MEM_OVERLAP_DEBUG
    MMK_CheckAllocatedMemInfo( _D_FILE_NAME, _D_FILE_LINE );
#endif
	SCI_TRACE_LOW ("[MMIIM] time_begin == %d, time_interval == %d", time_begin, SCI_GetTickCount() - time_begin);
	
    return result;
}



/*==============================================================================
Description: HandleSysMsg
Global resource dependence: NONE
Author: Lianxiang.Zhou
Note:
==============================================================================*/
LOCAL BOOLEAN HandleSysMsg(
    IM_DATA_T *data_ptr,
    GUIIM_EVENT_DATA_U const *event_data_ptr
)
{
    BOOLEAN is_omit_msg = FALSE;
    KEY_INFO_T *key_ptr = PNULL;
    GUI_POINT_T point = {0};
#if defined MMIIM_HW_FULLSCREEN_SUPPORT
    BOOLEAN is_pre_proc = FALSE;

    BOOLEAN hw_result = FALSE;
#endif

    CHECK_DATA(data_ptr);
    //SCI_ASSERT(PNULL != event_data_ptr); /*assert verified*/
    if(PNULL == event_data_ptr)
    {
        return  FALSE;
    }
    
    switch (event_data_ptr->sys_msg.msg_id)
    {
    case MSG_CTL_GET_FOCUS:

        if (data_ptr->more_setting_win_handle != 0)
        {
            MMIIM_KEYBOARD_SIZE_T kb_size = MMIIM_GetKeyboardSize();
            GUIIM_NOTIFY_PACK_T notify_pack = {0};
            BOOLEAN need_reset = FALSE;
            GUIIM_METHOD_T new_method = GUIIM_M_NONE;
            
            GUIIM_RemoveWin(data_ptr->init_param.im_handle,  data_ptr->more_setting_win_handle);
            data_ptr->more_setting_win_handle = 0;

            if (data_ptr->kb_size != kb_size)
            {
                data_ptr->kb_size = kb_size;
                SetPanel(data_ptr);
                need_reset = TRUE;
            }

            //有可能从更多窗口设置了新的输入语言，导致输入法发生改变
            if (MMIAPIIM_GetLanguage() != data_ptr->init_param.method_param_ptr->im_def_ptr->lang)  //输入语言发生改变
            {
                //get new method
                new_method = GetMethodBySwitchLang(data_ptr, MMIAPIIM_GetLanguage());
            }

            //输入法改变引起的重设
            if (new_method != GUIIM_M_NONE)
            {
                notify_pack.notify = GUIIM_NOTIFY_SET_METHOD;
                notify_pack.data.set_method = new_method;
                GUIIM_SetNotify(data_ptr->init_param.im_handle, &notify_pack);
            }
            //面板重设
            else if (need_reset)
            {
                TermImm(data_ptr);
                SetMethod(data_ptr, data_ptr->init_param.method_param_ptr->im_def_ptr->method);

                notify_pack.notify = GUIIM_NOTIFY_CHANGE_RECT;
                GUIIM_SetNotify(data_ptr->init_param.im_handle, &notify_pack);
            }

#if defined IM_HANDWRITING_HANWANG
            if ((!(need_reset || new_method != GUIIM_M_NONE))       //引起输入法重新初始化，不需要更新颜色
                && data_ptr->init_param.method_param_ptr->im_def_ptr->method == GUIIM_M_HANDWRITING)
            {   
                KERNEL_DATA_HW_T *hw_data_p = PNULL;
                uint32 hw_color = MMIIM_GetHwColor();
                
                hw_data_p = (KERNEL_DATA_HW_T*)(data_ptr->data);
                if (hw_data_p->trace_color != RGB565TO888(hw_color))
                {
                    hw_data_p->trace_color = RGB565TO888(hw_color);
                }
            }
#endif
        }
        else
        {
            ResetKernel(data_ptr);
        }

        break;

    case MSG_CTL_LOSE_FOCUS:

        if (PNULL != data_ptr->vkb.last_key)
        {
            if (data_ptr->vkb.last_key->is_press) data_ptr->vkb.last_key->is_press = 0;

            data_ptr->vkb.last_key = PNULL;
        }

        ClearTimer(data_ptr);
        ReleaseUILayer(data_ptr);
        ReleaseTipLayer(data_ptr);
        ReleaseEditLayer(data_ptr);
        MMIIM_CloseMethodSettingMenu (data_ptr);
        break;

#ifdef TOUCH_PANEL_SUPPORT //IGNORE9527
    case MSG_TP_PRESS_DOWN:
        point.x = MMK_GET_TP_X(event_data_ptr->sys_msg.param);
        point.y = MMK_GET_TP_Y(event_data_ptr->sys_msg.param);

        SCI_TraceLow("[MMIIM]HandleSysMsg MSG_TP_PRESS_DOWN point.x = %d, point.y = %d", point.x, point.y);

        if (data_ptr->vkb.state & KEYBOARD_CHOOSE_MENU)
        {
            MMIIM_MethodSettingMenuDown (data_ptr, point, TRUE);
            break;
        }        
        
#if defined MMIIM_HW_FULLSCREEN_SUPPORT
        hw_result = HWFullScreenPreProc_HandleTpMsg (data_ptr, event_data_ptr, &is_pre_proc);
        if (is_pre_proc)
        {
            //SCI_TraceLow:"HWFullScreenPreProc_HandleTpMsg MSG_TP_PRESS_DOWN point.x = %d, point.y = %d"
            SCI_TRACE_ID(TRACE_TOOL_CONVERT,MMIIM_TOUCH_APP_CSTAR_1330_112_2_18_2_26_46_74,(uint8*)"dd", point.x, point.y);
            is_omit_msg = !hw_result;
            break;
        }
#endif

        data_ptr->first_tp = point;
        data_ptr->last_tp = point;
        data_ptr->vkb.down_point = point;

        key_ptr = FindKey(data_ptr, &point);

        if (PNULL != key_ptr && PNULL != key_ptr->f_down
                && (0 == data_ptr->vkb.is_key_block || key_ptr == data_ptr->vkb.last_key))
        {
            PanelSlideCueClose (data_ptr, FALSE);  //有按键操作，关闭

            data_ptr->vkb.first_key = key_ptr;
            key_ptr->f_down(data_ptr, key_ptr);
        }

        break;
#endif //TOUCH_PANEL_SUPPORT //IGNORE9527

#ifdef TOUCH_PANEL_SUPPORT //IGNORE9527
    case MSG_TP_PRESS_MOVE:
        point.x = MMK_GET_TP_X(event_data_ptr->sys_msg.param);
        point.y = MMK_GET_TP_Y(event_data_ptr->sys_msg.param);

		SCI_TraceLow("[MMIIM]HandleSysMsg MSG_TP_PRESS_MOVE point.x = %d, point.y = %d", point.x, point.y);

#if defined MMIIM_HW_FULLSCREEN_SUPPORT
        hw_result = HWFullScreenPreProc_HandleTpMsg (data_ptr, event_data_ptr, &is_pre_proc);
        if (is_pre_proc)
        {
            //SCI_TraceLow:"HWFullScreenPreProc_HandleTpMsg MSG_TP_PRESS_MOVE point.x = %d, point.y = %d"
            SCI_TRACE_ID(TRACE_TOOL_CONVERT,MMIIM_TOUCH_APP_CSTAR_1362_112_2_18_2_26_46_76,(uint8*)"dd", point.x, point.y);
            is_omit_msg = !hw_result;
            break;
        }
#endif

        //在失去焦点并且重新获得之后，可能会丢失last key信息
        if (PNULL == data_ptr->vkb.last_key)
            break;

        if (data_ptr->vkb.state & KEYBOARD_CHOOSE_LETTER)
        {
            RefreshTipLetterSelectIndex(data_ptr, &point, TRUE);
            break;
        }
        else if (data_ptr->vkb.state & KEYBOARD_CHOOSE_MENU)
        {
            MMIIM_MethodSettingMenuRefresh (data_ptr, point, TRUE);
            break;
        }        

        data_ptr->last_tp = point;

        key_ptr = FindKey(data_ptr, &point);

        if (PNULL != key_ptr && PNULL != key_ptr->f_move
                && PNULL != data_ptr->vkb.last_key
                && (0 == data_ptr->vkb.is_key_block || key_ptr == data_ptr->vkb.last_key))
        {
            key_ptr->f_move(data_ptr, key_ptr);
        }

        break;
#endif //TOUCH_PANEL_SUPPORT //IGNORE9527

#ifdef TOUCH_PANEL_SUPPORT //IGNORE9527
    case MSG_TP_PRESS_LONG:
#if defined MMIIM_HW_FULLSCREEN_SUPPORT
        hw_result = HWFullScreenPreProc_HandleTpMsg (data_ptr, event_data_ptr, &is_pre_proc);
        if (is_pre_proc)
        {
            is_omit_msg = !hw_result;
            break;
        }
#endif
        
        point.x = MMK_GET_TP_X(event_data_ptr->sys_msg.param);
        point.y = MMK_GET_TP_Y(event_data_ptr->sys_msg.param);

        key_ptr = FindKey(data_ptr, &point);

        if (PNULL != key_ptr && PNULL != key_ptr->f_long
                && (0 == data_ptr->vkb.is_key_block || key_ptr == data_ptr->vkb.last_key))
        {
            key_ptr->f_long(data_ptr, key_ptr);
        }

        break;
#endif //TOUCH_PANEL_SUPPORT //IGNORE9527

#ifdef TOUCH_PANEL_SUPPORT //IGNORE9527
    case MSG_TP_PRESS_UP:
        {
            int16 delta_x = 0;
            int16 test_len = 0;
            BOOLEAN is_msg_deal = FALSE;

            point.x = MMK_GET_TP_X(event_data_ptr->sys_msg.param);
            point.y = MMK_GET_TP_Y(event_data_ptr->sys_msg.param);

            SCI_TraceLow("[MMIIM]HandleSysMsg MSG_TP_PRESS_UP point.x = %d, point.y = %d", point.x, point.y);

#if defined MMIIM_HW_FULLSCREEN_SUPPORT
            hw_result = HWFullScreenPreProc_HandleTpMsg (data_ptr, event_data_ptr, &is_pre_proc);
            if (is_pre_proc)
            {
                //SCI_TraceLow:"HWFullScreenPreProc_HandleTpMsg MSG_TP_PRESS_UP point.x = %d, point.y = %d"
                SCI_TRACE_ID(TRACE_TOOL_CONVERT,MMIIM_TOUCH_APP_CSTAR_1433_112_2_18_2_26_46_78,(uint8*)"dd", point.x, point.y);
                is_omit_msg = !hw_result;
                break;
            }
#endif
            if (data_ptr->vkb.state & KEYBOARD_CHOOSE_MENU)
            {
                MMIIM_MethodSettingMenuUp (data_ptr);
                break;
            }      
            
            //在失去焦点并且重新获得之后，可能会丢失last key信息
            if (PNULL == data_ptr->vkb.last_key)
                break;

            test_len = (data_ptr->rect.right - data_ptr->rect.left) / 10;
            test_len *= VKB_SLIDING_THRESHOLD;

            data_ptr->last_tp = point;

            delta_x = data_ptr->vkb.down_point.x - point.x;

            if (1 == data_ptr->vkb.is_key_block)
            {
                data_ptr->vkb.last_key->f_up(data_ptr, data_ptr->vkb.last_key);
                is_msg_deal = TRUE;
            }
            else if ((delta_x < (-1)*test_len || test_len < delta_x)
                     && PNULL != data_ptr->vkb.f_sliding)
            {
                int32 dir = (delta_x < (-1) * test_len) ? -1 : 1;

                is_msg_deal = data_ptr->vkb.f_sliding(data_ptr, dir);
            }

            if (!is_msg_deal)
            {
                key_ptr = FindKey(data_ptr, &point);

                if (PNULL != key_ptr && PNULL != key_ptr->f_up
                        && data_ptr->vkb.last_key == key_ptr)
                {
					SCI_TRACE_LOW ("[MMIIM] HandleSysMsg key_ptr->f_up key_ptr->code == %d, key_ptr->code - vkey_1 == %d, key_ptr->code - VKEY_A == %d", 
						key_ptr->code, key_ptr->code - VKEY_1, key_ptr->code - VKEY_A);
                    key_ptr->f_up(data_ptr, key_ptr);
                }
                else if (data_ptr->vkb.last_key->is_press)
                {
                    data_ptr->vkb.last_key->is_press = 0;
                    HideTip(data_ptr);
                    //MMIIM_DrawAll(data_ptr);
                    MMIIM_SetVKeyPaintStatus (data_ptr->vkb.last_key, TRUE);
					DrawVkb (data_ptr);
                }
            }
        }

        break;
#endif //TOUCH_PANEL_SUPPORT //IGNORE9527

    case MSG_APP_CANCEL:
//NEWMS00181788 [6530][64X64_320X240TK_QW]日历日程主题调出虚拟键盘后，右下角应该显示返回        
//PDA版本没有softkey，直接隐藏，但是非PDA版本有softkey，应该与softkey字符信息一致
#if defined MMI_PDA_SUPPORT         
        // 如果是PUBWIN窗口，不处理cancel消息，由PUBWIN直接退出窗口
        // 用param来判断是触屏还是按键来的CANCEL消息
        if (MMK_GetWinDisplayStyleState(data_ptr->init_param.win_handle, WS_HAS_PROMPT_WIN)
            /*&& 0 == event_data_ptr->sys_msg.param*/)    //needn't distinguish TP or KB msg.Bug 82226 - [ST][6530][128X64_320X480PDA2_builddir]进入编辑图片中的插入文字界面，按右键不能退出到图像编辑界面。
        {
            is_omit_msg = TRUE;
        }
        else
        {
            HidePanel(data_ptr);
        }
#else
        is_omit_msg = TRUE;    //让softkey自己处理
#endif
        break;

    default:
        is_omit_msg = TRUE;
        break;
    }

    return (!is_omit_msg);
}




/*==============================================================================
Description: 强制提交未提交的字符后的处理
Global resource dependence: NONE
Author: Lianxiang.Zhou
Note:
==============================================================================*/
LOCAL void ClearState(IM_DATA_T *data_ptr)
{
    BOOLEAN is_all_clear = FALSE;

    CHECK_DATA(data_ptr);

    is_all_clear = ClearTimer(data_ptr);

    UILAYER_RemoveBltLayer(&data_ptr->edit_layer);

    if (PNULL == data_ptr->vkb.keys)
    {
        return;
    }

    if (data_ptr->is_symbol_panel)
    {
        return;
    }

    switch (data_ptr->init_param.method_param_ptr->im_def_ptr->method)
    {
#if defined(IM_HANDWRITING_HANWANG)
    case GUIIM_M_HANDWRITING:
        if (!is_all_clear) HwClear(data_ptr);
        break;
#endif

    case GUIIM_M_TP_ENGLISH_ABC:
    case GUIIM_M_TP_ENGLISH_ABC_LOWER:
    case GUIIM_M_TP_ENGLISH_ABC_LEAD_UPPER:
    case GUIIM_M_TP_ENGLISH_ABC_UPPER:
        break;

    case GUIIM_M_TP_123:
    case GUIIM_M_TPQ_123:
        break;

    case GUIIM_M_TP_ENGLISH:
    case GUIIM_M_TP_ENGLISH_LOWER:
    case GUIIM_M_TP_ENGLISH_LEAD_UPPER:
    case GUIIM_M_TP_ENGLISH_UPPER:
        ThumbLatinClear(data_ptr);
        break;

#if defined (IM_SIMP_CHINESE_SUPPORT)
    case GUIIM_M_TP_PINYIN:
        ThumbPinyinClear(data_ptr);
        break;
#endif

#if defined (IM_SIMP_CHINESE_SUPPORT)
    case GUIIM_M_TP_STROKE:
    case GUIIM_M_TPQ_STROKE:
        ThumbStrokeClear(data_ptr);
        break;
#endif

    case GUIIM_M_TPQ_ENGLISH_ABC:
    case GUIIM_M_TPQ_ENGLISH_ABC_LOWER:
    case GUIIM_M_TPQ_ENGLISH_ABC_LEAD_UPPER:
    case GUIIM_M_TPQ_ENGLISH_ABC_UPPER:
        break;

    case GUIIM_M_TPQ_ENGLISH:
    case GUIIM_M_TPQ_ENGLISH_LOWER:
    case GUIIM_M_TPQ_ENGLISH_LEAD_UPPER:
    case GUIIM_M_TPQ_ENGLISH_UPPER:
        QwertLatinClear(data_ptr);
        break;

#if defined (IM_SIMP_CHINESE_SUPPORT)
    case GUIIM_M_TPQ_PINYIN:
        QwertPinyinClear(data_ptr);
        break;
#endif

    default:
        break;
    }

    return;
}


/*==============================================================================
Description: 清楚定时处理信息
Global resource dependence: NONE
Author: Lianxiang.Zhou
Note:
==============================================================================*/
LOCAL BOOLEAN ClearTimer(IM_DATA_T *data_ptr)
{
    BOOLEAN is_all_clear = FALSE;

    CHECK_DATA(data_ptr);

    if (0 != data_ptr->tip_hide_timer)
    {
        MMK_StopTimer(data_ptr->tip_hide_timer);
        data_ptr->tip_hide_timer = 0;
        UILAYER_RemoveBltLayer(&data_ptr->tip_layer);
        data_ptr->is_tip_display = FALSE;
    }

    if (0 != data_ptr->cue_hide_timer_id)
    {
        MMK_StopTimer(data_ptr->cue_hide_timer_id);
        data_ptr->cue_hide_timer_id = 0;

        if (data_ptr->vkb.vessel_key)
        {
            SCI_MEMSET (data_ptr->vkb.vessel_key->print_text, 0, sizeof(data_ptr->vkb.vessel_key->print_text)); 
            data_ptr->vkb.vessel_key->print_text_len= 0;
        }        
    }

    //force commit时，需要清空该状态，与输入法本身无关，某些职能输入法也许存在multi-tap字符
    if (data_ptr->multi_tap_data.commit_timer > 0)
    {
        MMK_StopTimer(data_ptr->multi_tap_data.commit_timer);
        data_ptr->multi_tap_data.commit_timer = 0;
        data_ptr->multi_tap_data.last_key_index = 0;
		data_ptr->multi_tap_data.last_key = PNULL;		
    }
    
    if (PNULL == data_ptr->vkb.keys)
    {
        return FALSE;
    }

    if (data_ptr->is_symbol_panel)
    {
        return FALSE;
    }

    switch (data_ptr->init_param.method_param_ptr->im_def_ptr->method)
    {
#if defined(IM_HANDWRITING_HANWANG)
    case GUIIM_M_HANDWRITING:

        if (((KERNEL_DATA_HW_T*)(data_ptr->data))->recognize_timer_id > 0)
        {
            MMK_StopTimer(((KERNEL_DATA_HW_T*)(data_ptr->data))->recognize_timer_id);
            ((KERNEL_DATA_HW_T*)(data_ptr->data))->recognize_timer_id = 0;
        }
#if defined MMIIM_HW_FULLSCREEN_SUPPORT
        {
            HwClear(data_ptr);
            is_all_clear = TRUE;
        }
#else   //非全屏手写会锁定按键，存在该状态
        if (data_ptr->vkb.is_key_block)
        {
            HwClear(data_ptr);
            is_all_clear = TRUE;
        }
#endif
        break;
#endif

    case GUIIM_M_TP_ENGLISH_ABC:
    case GUIIM_M_TP_ENGLISH_ABC_LOWER:
    case GUIIM_M_TP_ENGLISH_ABC_LEAD_UPPER:
    case GUIIM_M_TP_ENGLISH_ABC_UPPER:

        if (((KERNEL_DATA_ABC_T*)(data_ptr->data))->commit_timer > 0)
        {
            MMK_StopTimer(((KERNEL_DATA_ABC_T*)(data_ptr->data))->commit_timer);
            ((KERNEL_DATA_ABC_T*)(data_ptr->data))->commit_timer = 0;
            ((KERNEL_DATA_ABC_T*)(data_ptr->data))->last_key_index = 0;
        }

        break;

#if defined  IM_TRAD_CHINESE_SUPPORT
        case GUIIM_M_TP_ZHUYIN:
        //case GUIIM_M_TPQ_ZHUYIN:  //没有起timer
        if (((KERNEL_DATA_ZHUYIN_T*)(data_ptr->data))->commit_timer > 0)
        {
            MMK_StopTimer(((KERNEL_DATA_ZHUYIN_T*)(data_ptr->data))->commit_timer);
            ((KERNEL_DATA_ZHUYIN_T*)(data_ptr->data))->commit_timer = 0;
            ((KERNEL_DATA_ZHUYIN_T*)(data_ptr->data))->last_key_index = 0;
        }

        break;
#endif

    default:
        break;
    }

    return is_all_clear;
}


/*==============================================================================
Description: TermImm
Global resource dependence: NONE
Author: Lianxiang.Zhou
Note:
==============================================================================*/
LOCAL void TermImm(IM_DATA_T *data_ptr)
{
    CHECK_DATA(data_ptr);

    if (0 != data_ptr->tip_hide_timer)
    {
        MMK_StopTimer(data_ptr->tip_hide_timer);
        data_ptr->tip_hide_timer = 0;
    }

    if (0 != data_ptr->cue_hide_timer_id)
    {
        MMK_StopTimer(data_ptr->cue_hide_timer_id);
        data_ptr->cue_hide_timer_id = 0;
    }

    ClearMultitapTimer (data_ptr);
    
    UILAYER_RemoveBltLayer(&data_ptr->tip_layer);
    data_ptr->is_tip_display = FALSE;
    UILAYER_RemoveBltLayer(&data_ptr->edit_layer);
    MMIIM_CloseMethodSettingMenu (data_ptr);
    
    if (PNULL == data_ptr->vkb.keys)
    {
        SCI_TRACE_LOW("[MMIIM] TP TermImm: vkb.keys is null.");
        
        return;
    }

    if (data_ptr->is_symbol_panel)
    {
        SCI_TRACE_LOW("[MMIIM] TP TermImm: SymTerm.");
        SymTerm(data_ptr);
        return;
    }

    switch (data_ptr->init_param.method_param_ptr->im_def_ptr->method)
    {
#if defined(IM_HANDWRITING_HANWANG)
    case GUIIM_M_HANDWRITING:
        g_default_ch_type = GUIIM_TYPE_NONE;
        g_default_input_type = GUIIM_INPUT_TYPE_HANDWRITING;
#if defined MMIIM_HW_FULLSCREEN_SUPPORT
        if ( MMIAPIIM_HWGetAreaType () )
        {
            HwFullScreenTerm (data_ptr);
        }
        else
        {
            HwTerm(data_ptr);
        }
#else
        HwTerm(data_ptr);
#endif
        break;
#endif

    case GUIIM_M_TP_123:
    case GUIIM_M_TPQ_123:
        DigitTerm(data_ptr);
        break;

    case GUIIM_M_TP_ENGLISH_ABC:
    case GUIIM_M_TP_ENGLISH_ABC_LOWER:
    case GUIIM_M_TP_ENGLISH_ABC_LEAD_UPPER:
    case GUIIM_M_TP_ENGLISH_ABC_UPPER:
        ThumbAbcTerm(data_ptr);
        g_default_en_type = GUIIM_TYPE_MULTITAP;
        g_default_input_type = GUIIM_INPUT_TYPE_TOUCHPEN;
        break;

    case GUIIM_M_TP_ENGLISH:
    case GUIIM_M_TP_ENGLISH_LOWER:
    case GUIIM_M_TP_ENGLISH_LEAD_UPPER:
    case GUIIM_M_TP_ENGLISH_UPPER:
        ThumbLatinTerm(data_ptr);
        g_default_en_type = GUIIM_TYPE_SMART;
        g_default_input_type = GUIIM_INPUT_TYPE_TOUCHPEN;
        break;

    case GUIIM_M_TPQ_ENGLISH_ABC:
    case GUIIM_M_TPQ_ENGLISH_ABC_LOWER:
    case GUIIM_M_TPQ_ENGLISH_ABC_LEAD_UPPER:
    case GUIIM_M_TPQ_ENGLISH_ABC_UPPER:
        QwertAbcTerm(data_ptr);
        g_default_en_type = GUIIM_TYPE_MULTITAP;
        g_default_input_type = GUIIM_INPUT_TYPE_TP_QWERT;
        break;

    case GUIIM_M_TPQ_ENGLISH:
    case GUIIM_M_TPQ_ENGLISH_LOWER:
    case GUIIM_M_TPQ_ENGLISH_LEAD_UPPER:
    case GUIIM_M_TPQ_ENGLISH_UPPER:
        QwertLatinTerm(data_ptr);
        g_default_en_type = GUIIM_TYPE_SMART;
        g_default_input_type = GUIIM_INPUT_TYPE_TP_QWERT;
        break;
		
#if defined (IM_SIMP_CHINESE_SUPPORT)
    case GUIIM_M_TP_PINYIN:
        ThumbPinyinTerm(data_ptr);
        g_default_ch_type = GUIIM_TYPE_SMART;
        g_default_input_type = GUIIM_INPUT_TYPE_TOUCHPEN;
        break;

	case GUIIM_M_TPQ_PINYIN:
        QwertPinyinTerm(data_ptr);
        g_default_ch_type = GUIIM_TYPE_SMART;
        g_default_input_type = GUIIM_INPUT_TYPE_TP_QWERT;
        break;

    case GUIIM_M_TP_STROKE:
        ThumbStrokeTerm(data_ptr);
        g_default_ch_type = GUIIM_TYPE_STROKE;
        g_default_input_type = GUIIM_INPUT_TYPE_TOUCHPEN;
        break;

    case GUIIM_M_TPQ_STROKE:
        ThumbStrokeTerm(data_ptr);
        g_default_ch_type = GUIIM_TYPE_STROKE;
        g_default_input_type = GUIIM_INPUT_TYPE_TP_QWERT;
        break;
#endif

//繁体中文
#if defined (IM_TRAD_CHINESE_SUPPORT)
    case GUIIM_M_TP_ZHUYIN:
        {
            ThumbZhuyinTerm (data_ptr);
            g_default_ch_type = GUIIM_TYPE_SMART;
            g_default_input_type = GUIIM_INPUT_TYPE_TOUCHPEN;
            break;
        }
    
    case GUIIM_M_TPQ_ZHUYIN:
        {
            QwertZhuyinTerm (data_ptr);
            g_default_ch_type = GUIIM_TYPE_SMART;
            g_default_input_type = GUIIM_INPUT_TYPE_TP_QWERT;
            break;
        }

    case GUIIM_M_TP_STROKE_CHT:
        ThumbStrokeTerm(data_ptr);
        g_default_ch_type = GUIIM_TYPE_STROKE;
        g_default_input_type = GUIIM_INPUT_TYPE_TOUCHPEN;
        break;

    case GUIIM_M_TPQ_STROKE_CHT:
        ThumbStrokeTerm(data_ptr);
        g_default_ch_type = GUIIM_TYPE_STROKE;
        g_default_input_type = GUIIM_INPUT_TYPE_TP_QWERT;
        break;
#endif 

//阿姆哈拉9键没有走multi-tap流程
#ifdef IM_AMHARIC_SUPPORT
    case GUIIM_M_TP_AMHARIC_ABC:
        {
            ThumbAmharicTerm (data_ptr);
            g_default_ch_type = GUIIM_TYPE_MULTITAP;
            g_default_input_type = GUIIM_INPUT_TYPE_TOUCHPEN;
            break;
        }
#endif

//孟加拉9键
#ifdef IM_BENGALI_SUPPORT
    case GUIIM_M_TP_BENGALI:
        {
            ThumbBengaliTerm (data_ptr);
            g_default_ch_type = GUIIM_TYPE_SMART;
            g_default_input_type = GUIIM_INPUT_TYPE_TOUCHPEN;
            break;
        }

	case GUIIM_M_TP_BENGALI_ABC:		//这个我们自己的multi-tap无法满足孟加拉BTRC电信规范，需要另作处理
		{
			ThumbBengaliMultitapTerm (data_ptr);
            g_default_ch_type = GUIIM_TYPE_MULTITAP;
            g_default_input_type = GUIIM_INPUT_TYPE_TOUCHPEN;
			break;
		}
#endif

    default:
        {
            GUIIM_METHOD_CFG_T *method_cfg_ptr = PNULL;
            
            method_cfg_ptr = MMITHEME_IMGetDefByMethod(data_ptr->init_param.method_param_ptr->im_def_ptr->method);
            if(method_cfg_ptr)
            {
                //9键
                if (method_cfg_ptr->input == GUIIM_INPUT_TYPE_TOUCHPEN)
                {
                    //智能
                    if(method_cfg_ptr->type == GUIIM_TYPE_SMART)
                    {
                        ThumbSmartTerm(data_ptr);
                        g_default_ch_type = GUIIM_TYPE_SMART;
                        g_default_input_type = GUIIM_INPUT_TYPE_TOUCHPEN;
                    }
                    else if (method_cfg_ptr->type == GUIIM_TYPE_MULTITAP)
                    {
                        ThumbMultiTapTerm (data_ptr);
                        g_default_ch_type = GUIIM_TYPE_MULTITAP;
                        g_default_input_type = GUIIM_INPUT_TYPE_TOUCHPEN;
                    }
                }
                //26键
                else if (method_cfg_ptr->input == GUIIM_INPUT_TYPE_TP_QWERT)
                {
                     //智能
                    if(method_cfg_ptr->type == GUIIM_TYPE_SMART)
                    {
                        QwertSmartTerm (data_ptr);
                        g_default_ch_type = GUIIM_TYPE_SMART;
                        g_default_input_type = GUIIM_INPUT_TYPE_TP_QWERT;
                    }
                    else if (method_cfg_ptr->type == GUIIM_TYPE_MULTITAP)
                    {
                        QwertMultiTapTerm(data_ptr);
                        g_default_ch_type = GUIIM_TYPE_MULTITAP;
                        g_default_input_type = GUIIM_INPUT_TYPE_TP_QWERT;
                    }
                }
            }
            else
            {
                SCI_TRACE_LOW("[MMIIM] TP TermImm: default unreason switch.");
            }
        } 

        break;
    }

    return;
}


/*==============================================================================
Description: SetMethod
Global resource dependence: NONE
Author: Lianxiang.Zhou
Note:
==============================================================================*/
LOCAL BOOLEAN SetMethod(
    IM_DATA_T *data_ptr,
    GUIIM_METHOD_T method
)
{
    BOOLEAN is_init = FALSE;

    CHECK_DATA(data_ptr);
    
    SCI_TRACE_LOW("[MMIIM] TP SetMethod: data_ptr=%08X, method=%04X", data_ptr, method);

    switch (method)
    {
#if defined(IM_HANDWRITING_HANWANG)
    case GUIIM_M_HANDWRITING:
        //进入手写前，记录非手写输入方式，防止手写时，切换语言，导致输入方式g_default_input_type记录错误
        if (g_default_input_type != GUIIM_INPUT_TYPE_HANDWRITING)
        {
            g_entry_hw_input_type = g_default_input_type;
        }

#if defined MMIIM_HW_FULLSCREEN_SUPPORT
            MMIAPIIM_HWSetAreaType (MMIIM_HW_AREA_TYPE_FULL_SCREEN);
#endif

#if defined MMIIM_HW_FULLSCREEN_SUPPORT
            if ( MMIAPIIM_HWGetAreaType () )
            {
                //ReleaseUILayer(data_ptr);
                is_init = HwFullScreenInit (data_ptr);
            }
            else
            {
                is_init = HwInit(data_ptr);
            }
#else
            is_init = HwInit(data_ptr);
#endif

        break;
#endif

    case GUIIM_M_TP_123:
    case GUIIM_M_TPQ_123:
        is_init = DigitInit(data_ptr);
        break;

//简体中文
#if defined (IM_SIMP_CHINESE_SUPPORT)
    case GUIIM_M_TP_PINYIN:
        is_init = ThumbPinyinInit(data_ptr);
        break;

    case GUIIM_M_TPQ_PINYIN:
        is_init = QwertPinyinInit(data_ptr);
        break;

    case GUIIM_M_TP_STROKE:
    case GUIIM_M_TPQ_STROKE:
        is_init = ThumbStrokeInit(data_ptr);
        break;
#endif

//繁体中文
#if defined (IM_TRAD_CHINESE_SUPPORT)
    case GUIIM_M_TP_ZHUYIN:
        is_init = ThumbZhuyinInit(data_ptr);
        break;

    case GUIIM_M_TPQ_ZHUYIN:
        is_init = QwertZhuyinInit(data_ptr);
        break;

    case GUIIM_M_TP_STROKE_CHT:
    case GUIIM_M_TPQ_STROKE_CHT:
        is_init = ThumbStrokeInit(data_ptr);
        break;
#endif

        //ARABIC 阿拉伯
#if defined (IM_ARABIC_SUPPORT)
    case GUIIM_M_TP_ARABIC:
        is_init = ThumbSmartInit(data_ptr);
        break;

    case GUIIM_M_TPQ_ARABIC:
        is_init = QwertSmartInit(data_ptr);
        break;
    case GUIIM_M_TP_ARABIC_ABC:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_ARABIC_ABC:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

//ASSAMESE
#if defined (IM_ASSAMESE_SUPPORT)
    case GUIIM_M_TP_ASSAMESE:
        is_init = ThumbSmartInit(data_ptr);
        break;

    case GUIIM_M_TPQ_ASSAMESE:
        is_init = QwertSmartInit(data_ptr);
        break;
    case GUIIM_M_TP_ASSAMESE_ABC:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_ASSAMESE_ABC:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

//BENGALI
#if defined (IM_BENGALI_SUPPORT)		
    case GUIIM_M_TP_BENGALI:
        is_init = ThumbBengaliInit(data_ptr);	//孟加拉的* #号键有电信规范，这个不能使用通用版本
        break;

    case GUIIM_M_TPQ_BENGALI:
        is_init = QwertSmartInit(data_ptr);
        break;

	//孟加拉存在某些字符必须在特定字符后面才能输入的情况，multi-tap输入法无法满足这种输入规则，
	//所以我们使用cstar的multi-tap输入法，需要特殊处理
    case GUIIM_M_TP_BENGALI_ABC:
        is_init = ThumbBengaliMultitapInit (data_ptr);
        break;

    case GUIIM_M_TPQ_BENGALI_ABC:
        is_init = QwertMultiTapInit (data_ptr);
        break;
#endif		

//GEORGIAN
#if defined (IM_GEORGIAN_SUPPORT)
    case GUIIM_M_TP_GEORGIAN:
        is_init = ThumbSmartInit(data_ptr);
        break;

    case GUIIM_M_TPQ_GEORGIAN:
        is_init = QwertSmartInit(data_ptr);
        break;
    case GUIIM_M_TP_GEORGIAN_ABC:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_GEORGIAN_ABC:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

//GUJARATI
#if defined (IM_GUJARATI_SUPPORT)
    case GUIIM_M_TP_GUJARATI:
        is_init = ThumbSmartInit(data_ptr);
        break;

    case GUIIM_M_TPQ_GUJARATI:
        is_init = QwertSmartInit(data_ptr);
        break;
    case GUIIM_M_TP_GUJARATI_ABC:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_GUJARATI_ABC:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

//HEBREW
#if defined (IM_HEBREW_SUPPORT)
    case GUIIM_M_TP_HEBREW:
        is_init = ThumbSmartInit(data_ptr);
        break;

    case GUIIM_M_TPQ_HEBREW:
        is_init = QwertSmartInit(data_ptr);
        break;
    case GUIIM_M_TP_HEBREW_ABC:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_HEBREW_ABC:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //印地
#ifdef IM_HINDI_SUPPORT
    case GUIIM_M_TP_HINDI:
        {
            is_init = ThumbSmartInit(data_ptr);
            break;
        }

    case GUIIM_M_TPQ_HINDI:
        {
            is_init = QwertSmartInit(data_ptr);
            break;
        }
    case GUIIM_M_TP_HINDI_ABC:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_HINDI_ABC:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //卡纳达
#ifdef IM_KANNADA_SUPPORT
    case GUIIM_M_TP_KANNADA:
        {
            is_init = ThumbSmartInit(data_ptr);
            break;
        }

    case GUIIM_M_TPQ_KANNADA:
        {
            is_init = QwertSmartInit(data_ptr);
            break;
        }
    case GUIIM_M_TP_KANNADA_ABC:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_KANNADA_ABC:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //MALAYALAM
#ifdef IM_MALAYALAM_SUPPORT
    case GUIIM_M_TP_MALAYALAM:
        {
            is_init = ThumbSmartInit(data_ptr);
            break;
        }

    case GUIIM_M_TPQ_MALAYALAM:
        {
            is_init = QwertSmartInit(data_ptr);
            break;
        }
    case GUIIM_M_TP_MALAYALAM_ABC:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_MALAYALAM_ABC:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //MARATHI
#ifdef IM_MARATHI_SUPPORT
    case GUIIM_M_TP_MARATHI:
        {
            is_init = ThumbSmartInit(data_ptr);
            break;
        }

    case GUIIM_M_TPQ_MARATHI:
        {
            is_init = QwertSmartInit(data_ptr);
            break;
        }
    case GUIIM_M_TP_MARATHI_ABC:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_MARATHI_ABC:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //ORIYA
#ifdef IM_ORIYA_SUPPORT
    case GUIIM_M_TP_ORIYA:
        {
            is_init = ThumbSmartInit(data_ptr);
            break;
        }

    case GUIIM_M_TPQ_ORIYA:
        {
            is_init = QwertSmartInit(data_ptr);
            break;
        }
    case GUIIM_M_TP_ORIYA_ABC:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_ORIYA_ABC:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //波斯
#ifdef IM_PERSIAN_SUPPORT
    case GUIIM_M_TP_PERSIAN:
        {
            is_init = ThumbSmartInit(data_ptr);
            break;
        }

    case GUIIM_M_TPQ_PERSIAN:
        {
            is_init = QwertSmartInit(data_ptr);
            break;
        }
    case GUIIM_M_TP_PERSIAN_ABC:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_PERSIAN_ABC:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //PUNJABI
#ifdef IM_PUNJABI_SUPPORT
    case GUIIM_M_TP_PUNJABI:
        {
            is_init = ThumbSmartInit(data_ptr);
            break;
        }

    case GUIIM_M_TPQ_PUNJABI:
        {
            is_init = QwertSmartInit(data_ptr);
            break;
        }
    case GUIIM_M_TP_PUNJABI_ABC:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_PUNJABI_ABC:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //TAGALOG
#ifdef IM_TAGALOG_SUPPORT
    case GUIIM_M_TP_TAGALOG:
        {
            is_init = ThumbSmartInit(data_ptr);
            break;
        }

    case GUIIM_M_TPQ_TAGALOG:
        {
            is_init = QwertSmartInit(data_ptr);
            break;
        }
    case GUIIM_M_TP_TAGALOG_ABC:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_TAGALOG_ABC:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //TAMIL
#ifdef IM_TAMIL_SUPPORT
    case GUIIM_M_TP_TAMIL:
        {
            is_init = ThumbSmartInit(data_ptr);
            break;
        }

    case GUIIM_M_TPQ_TAMIL:
        {
            is_init = QwertSmartInit(data_ptr);
            break;
        }
    case GUIIM_M_TP_TAMIL_ABC:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_TAMIL_ABC:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //TELUGU
#ifdef IM_TELUGU_SUPPORT
    case GUIIM_M_TP_TELUGU:
        {
            is_init = ThumbSmartInit(data_ptr);
            break;
        }

    case GUIIM_M_TPQ_TELUGU:
        {
            is_init = QwertSmartInit(data_ptr);
            break;
        }
    case GUIIM_M_TP_TELUGU_ABC:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_TELUGU_ABC:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //THAI
#ifdef IM_THAI_SUPPORT
    case GUIIM_M_TP_THAI:
        {
            is_init = ThumbSmartInit(data_ptr);
            break;
        }

    case GUIIM_M_TPQ_THAI:
        {
            is_init = QwertSmartInit(data_ptr);
            break;
        }
    case GUIIM_M_TP_THAI_ABC:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_THAI_ABC:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //乌尔都
#ifdef IM_URDU_SUPPORT
    case GUIIM_M_TP_URDU:
        {
            is_init = ThumbSmartInit(data_ptr);
            break;
        }

    case GUIIM_M_TPQ_URDU:
        {
            is_init = QwertSmartInit(data_ptr);
            break;
        }
    case GUIIM_M_TP_URDU_ABC:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_URDU_ABC:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //AFRIKAANS
#ifdef IM_AFRIKAANS_SUPPORT
    case GUIIM_M_TP_AFRIKAANS:
    case GUIIM_M_TP_AFRIKAANS_LEAD_UPPER:
    case GUIIM_M_TP_AFRIKAANS_LOWER:
    case GUIIM_M_TP_AFRIKAANS_UPPER:
        {
            is_init = ThumbSmartInit(data_ptr);
            break;
        }

    case GUIIM_M_TPQ_AFRIKAANS:
    case GUIIM_M_TPQ_AFRIKAANS_LEAD_UPPER:
    case GUIIM_M_TPQ_AFRIKAANS_LOWER:
    case GUIIM_M_TPQ_AFRIKAANS_UPPER:
        {
            is_init = QwertSmartInit(data_ptr);
            break;
        }

    case GUIIM_M_TP_AFRIKAANS_ABC:
    case GUIIM_M_TP_AFRIKAANS_ABC_LEAD_UPPER:
    case GUIIM_M_TP_AFRIKAANS_ABC_LOWER:
    case GUIIM_M_TP_AFRIKAANS_ABC_UPPER:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_AFRIKAANS_ABC:
    case GUIIM_M_TPQ_AFRIKAANS_ABC_LEAD_UPPER:
    case GUIIM_M_TPQ_AFRIKAANS_ABC_LOWER:
    case GUIIM_M_TPQ_AFRIKAANS_ABC_UPPER:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //ALBANIAN
#ifdef IM_ALBANIAN_SUPPORT
    case GUIIM_M_TP_ALBANIAN:
    case GUIIM_M_TP_ALBANIAN_LEAD_UPPER:
    case GUIIM_M_TP_ALBANIAN_LOWER:
    case GUIIM_M_TP_ALBANIAN_UPPER:
        {
            is_init = ThumbSmartInit(data_ptr);
            break;
        }

    case GUIIM_M_TPQ_ALBANIAN:
    case GUIIM_M_TPQ_ALBANIAN_LEAD_UPPER:
    case GUIIM_M_TPQ_ALBANIAN_LOWER:
    case GUIIM_M_TPQ_ALBANIAN_UPPER:
        {
            is_init = QwertSmartInit(data_ptr);
            break;
        }

    case GUIIM_M_TP_ALBANIAN_ABC:
    case GUIIM_M_TP_ALBANIAN_ABC_LEAD_UPPER:
    case GUIIM_M_TP_ALBANIAN_ABC_LOWER:
    case GUIIM_M_TP_ALBANIAN_ABC_UPPER:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_ALBANIAN_ABC:
    case GUIIM_M_TPQ_ALBANIAN_ABC_LEAD_UPPER:
    case GUIIM_M_TPQ_ALBANIAN_ABC_LOWER:
    case GUIIM_M_TPQ_ALBANIAN_ABC_UPPER:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //ARMENIAN
#ifdef IM_ARMENIAN_SUPPORT
    case GUIIM_M_TP_ARMENIAN:
    case GUIIM_M_TP_ARMENIAN_LEAD_UPPER:
    case GUIIM_M_TP_ARMENIAN_LOWER:
    case GUIIM_M_TP_ARMENIAN_UPPER:
        {
            is_init = ThumbSmartInit(data_ptr);
            break;
        }

    case GUIIM_M_TPQ_ARMENIAN:
    case GUIIM_M_TPQ_ARMENIAN_LEAD_UPPER:
    case GUIIM_M_TPQ_ARMENIAN_LOWER:
    case GUIIM_M_TPQ_ARMENIAN_UPPER:
        {
            is_init = QwertSmartInit(data_ptr);
            break;
        }

    case GUIIM_M_TP_ARMENIAN_ABC:
    case GUIIM_M_TP_ARMENIAN_ABC_LEAD_UPPER:
    case GUIIM_M_TP_ARMENIAN_ABC_LOWER:
    case GUIIM_M_TP_ARMENIAN_ABC_UPPER:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_ARMENIAN_ABC:
    case GUIIM_M_TPQ_ARMENIAN_ABC_LEAD_UPPER:
    case GUIIM_M_TPQ_ARMENIAN_ABC_LOWER:
    case GUIIM_M_TPQ_ARMENIAN_ABC_UPPER:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //AZERBAIJANI
#ifdef IM_AZERBAIJANI_SUPPORT
    case GUIIM_M_TP_AZERBAIJANI:
    case GUIIM_M_TP_AZERBAIJANI_LEAD_UPPER:
    case GUIIM_M_TP_AZERBAIJANI_LOWER:
    case GUIIM_M_TP_AZERBAIJANI_UPPER:
        {
            is_init = ThumbSmartInit(data_ptr);
            break;
        }

    case GUIIM_M_TPQ_AZERBAIJANI:
    case GUIIM_M_TPQ_AZERBAIJANI_LEAD_UPPER:
    case GUIIM_M_TPQ_AZERBAIJANI_LOWER:
    case GUIIM_M_TPQ_AZERBAIJANI_UPPER:
        {
            is_init = QwertSmartInit(data_ptr);
            break;
        }

    case GUIIM_M_TP_AZERBAIJANI_ABC:
    case GUIIM_M_TP_AZERBAIJANI_ABC_LEAD_UPPER:
    case GUIIM_M_TP_AZERBAIJANI_ABC_LOWER:
    case GUIIM_M_TP_AZERBAIJANI_ABC_UPPER:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_AZERBAIJANI_ABC:
    case GUIIM_M_TPQ_AZERBAIJANI_ABC_LEAD_UPPER:
    case GUIIM_M_TPQ_AZERBAIJANI_ABC_LOWER:
    case GUIIM_M_TPQ_AZERBAIJANI_ABC_UPPER:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //BASQUE
#ifdef IM_BASQUE_SUPPORT
    case GUIIM_M_TP_BASQUE:
    case GUIIM_M_TP_BASQUE_LEAD_UPPER:
    case GUIIM_M_TP_BASQUE_LOWER:
    case GUIIM_M_TP_BASQUE_UPPER:
        {
            is_init = ThumbSmartInit(data_ptr);
            break;
        }

    case GUIIM_M_TPQ_BASQUE:
    case GUIIM_M_TPQ_BASQUE_LEAD_UPPER:
    case GUIIM_M_TPQ_BASQUE_LOWER:
    case GUIIM_M_TPQ_BASQUE_UPPER:
        {
            is_init = QwertSmartInit(data_ptr);
            break;
        }

    case GUIIM_M_TP_BASQUE_ABC:
    case GUIIM_M_TP_BASQUE_ABC_LEAD_UPPER:
    case GUIIM_M_TP_BASQUE_ABC_LOWER:
    case GUIIM_M_TP_BASQUE_ABC_UPPER:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_BASQUE_ABC:
    case GUIIM_M_TPQ_BASQUE_ABC_LEAD_UPPER:
    case GUIIM_M_TPQ_BASQUE_ABC_LOWER:
    case GUIIM_M_TPQ_BASQUE_ABC_UPPER:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //BULGARIAN
#ifdef IM_BULGARIAN_SUPPORT
    case GUIIM_M_TP_BULGARIAN:
    case GUIIM_M_TP_BULGARIAN_LEAD_UPPER:
    case GUIIM_M_TP_BULGARIAN_LOWER:
    case GUIIM_M_TP_BULGARIAN_UPPER:
        {
            is_init = ThumbSmartInit(data_ptr);
            break;
        }

    case GUIIM_M_TPQ_BULGARIAN:
    case GUIIM_M_TPQ_BULGARIAN_LEAD_UPPER:
    case GUIIM_M_TPQ_BULGARIAN_LOWER:
    case GUIIM_M_TPQ_BULGARIAN_UPPER:
        {
            is_init = QwertSmartInit(data_ptr);
            break;
        }

    case GUIIM_M_TP_BULGARIAN_ABC:
    case GUIIM_M_TP_BULGARIAN_ABC_LEAD_UPPER:
    case GUIIM_M_TP_BULGARIAN_ABC_LOWER:
    case GUIIM_M_TP_BULGARIAN_ABC_UPPER:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_BULGARIAN_ABC:
    case GUIIM_M_TPQ_BULGARIAN_ABC_LEAD_UPPER:
    case GUIIM_M_TPQ_BULGARIAN_ABC_LOWER:
    case GUIIM_M_TPQ_BULGARIAN_ABC_UPPER:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //CATALAN
#ifdef IM_CATALAN_SUPPORT
    case GUIIM_M_TP_CATALAN:
    case GUIIM_M_TP_CATALAN_LEAD_UPPER:
    case GUIIM_M_TP_CATALAN_LOWER:
    case GUIIM_M_TP_CATALAN_UPPER:
        {
            is_init = ThumbSmartInit(data_ptr);
            break;
        }

    case GUIIM_M_TPQ_CATALAN:
    case GUIIM_M_TPQ_CATALAN_LEAD_UPPER:
    case GUIIM_M_TPQ_CATALAN_LOWER:
    case GUIIM_M_TPQ_CATALAN_UPPER:
        {
            is_init = QwertSmartInit(data_ptr);
            break;
        }

    case GUIIM_M_TP_CATALAN_ABC:
    case GUIIM_M_TP_CATALAN_ABC_LEAD_UPPER:
    case GUIIM_M_TP_CATALAN_ABC_LOWER:
    case GUIIM_M_TP_CATALAN_ABC_UPPER:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_CATALAN_ABC:
    case GUIIM_M_TPQ_CATALAN_ABC_LEAD_UPPER:
    case GUIIM_M_TPQ_CATALAN_ABC_LOWER:
    case GUIIM_M_TPQ_CATALAN_ABC_UPPER:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //CROATIAN
#ifdef IM_CROATIAN_SUPPORT
    case GUIIM_M_TP_CROATIAN:
    case GUIIM_M_TP_CROATIAN_LEAD_UPPER:
    case GUIIM_M_TP_CROATIAN_LOWER:
    case GUIIM_M_TP_CROATIAN_UPPER:
        {
            is_init = ThumbSmartInit(data_ptr);
            break;
        }

    case GUIIM_M_TPQ_CROATIAN:
    case GUIIM_M_TPQ_CROATIAN_LEAD_UPPER:
    case GUIIM_M_TPQ_CROATIAN_LOWER:
    case GUIIM_M_TPQ_CROATIAN_UPPER:
        {
            is_init = QwertSmartInit(data_ptr);
            break;
        }

    case GUIIM_M_TP_CROATIAN_ABC:
    case GUIIM_M_TP_CROATIAN_ABC_LEAD_UPPER:
    case GUIIM_M_TP_CROATIAN_ABC_LOWER:
    case GUIIM_M_TP_CROATIAN_ABC_UPPER:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_CROATIAN_ABC:
    case GUIIM_M_TPQ_CROATIAN_ABC_LEAD_UPPER:
    case GUIIM_M_TPQ_CROATIAN_ABC_LOWER:
    case GUIIM_M_TPQ_CROATIAN_ABC_UPPER:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //CZECH
#ifdef IM_CZECH_SUPPORT
    case GUIIM_M_TP_CZECH:
    case GUIIM_M_TP_CZECH_LEAD_UPPER:
    case GUIIM_M_TP_CZECH_LOWER:
    case GUIIM_M_TP_CZECH_UPPER:
        {
            is_init = ThumbSmartInit(data_ptr);
            break;
        }

    case GUIIM_M_TPQ_CZECH:
    case GUIIM_M_TPQ_CZECH_LEAD_UPPER:
    case GUIIM_M_TPQ_CZECH_LOWER:
    case GUIIM_M_TPQ_CZECH_UPPER:
        {
            is_init = QwertSmartInit(data_ptr);
            break;
        }

    case GUIIM_M_TP_CZECH_ABC:
    case GUIIM_M_TP_CZECH_ABC_LEAD_UPPER:
    case GUIIM_M_TP_CZECH_ABC_LOWER:
    case GUIIM_M_TP_CZECH_ABC_UPPER:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_CZECH_ABC:
    case GUIIM_M_TPQ_CZECH_ABC_LEAD_UPPER:
    case GUIIM_M_TPQ_CZECH_ABC_LOWER:
    case GUIIM_M_TPQ_CZECH_ABC_UPPER:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //DANISH
#ifdef IM_DANISH_SUPPORT
    case GUIIM_M_TP_DANISH:
    case GUIIM_M_TP_DANISH_LEAD_UPPER:
    case GUIIM_M_TP_DANISH_LOWER:
    case GUIIM_M_TP_DANISH_UPPER:
        {
            is_init = ThumbSmartInit(data_ptr);
            break;
        }

    case GUIIM_M_TPQ_DANISH:
    case GUIIM_M_TPQ_DANISH_LEAD_UPPER:
    case GUIIM_M_TPQ_DANISH_LOWER:
    case GUIIM_M_TPQ_DANISH_UPPER:
        {
            is_init = QwertSmartInit(data_ptr);
            break;
        }

    case GUIIM_M_TP_DANISH_ABC:
    case GUIIM_M_TP_DANISH_ABC_LEAD_UPPER:
    case GUIIM_M_TP_DANISH_ABC_LOWER:
    case GUIIM_M_TP_DANISH_ABC_UPPER:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_DANISH_ABC:
    case GUIIM_M_TPQ_DANISH_ABC_LEAD_UPPER:
    case GUIIM_M_TPQ_DANISH_ABC_LOWER:
    case GUIIM_M_TPQ_DANISH_ABC_UPPER:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //DUTCH
#ifdef IM_DUTCH_SUPPORT
    case GUIIM_M_TP_DUTCH:
    case GUIIM_M_TP_DUTCH_LEAD_UPPER:
    case GUIIM_M_TP_DUTCH_LOWER:
    case GUIIM_M_TP_DUTCH_UPPER:
        {
            is_init = ThumbSmartInit(data_ptr);
            break;
        }

    case GUIIM_M_TPQ_DUTCH:
    case GUIIM_M_TPQ_DUTCH_LEAD_UPPER:
    case GUIIM_M_TPQ_DUTCH_LOWER:
    case GUIIM_M_TPQ_DUTCH_UPPER:
        {
            is_init = QwertSmartInit(data_ptr);
            break;
        }

    case GUIIM_M_TP_DUTCH_ABC:
    case GUIIM_M_TP_DUTCH_ABC_LEAD_UPPER:
    case GUIIM_M_TP_DUTCH_ABC_LOWER:
    case GUIIM_M_TP_DUTCH_ABC_UPPER:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_DUTCH_ABC:
    case GUIIM_M_TPQ_DUTCH_ABC_LEAD_UPPER:
    case GUIIM_M_TPQ_DUTCH_ABC_LOWER:
    case GUIIM_M_TPQ_DUTCH_ABC_UPPER:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

    case GUIIM_M_TP_ENGLISH_ABC:
    case GUIIM_M_TP_ENGLISH_ABC_LOWER:
    case GUIIM_M_TP_ENGLISH_ABC_LEAD_UPPER:
    case GUIIM_M_TP_ENGLISH_ABC_UPPER:
        is_init = ThumbAbcInit(data_ptr);
        break;

    case GUIIM_M_TP_ENGLISH:
    case GUIIM_M_TP_ENGLISH_LOWER:
    case GUIIM_M_TP_ENGLISH_LEAD_UPPER:
    case GUIIM_M_TP_ENGLISH_UPPER:
        is_init = ThumbLatinInit(data_ptr);
        break;

    case GUIIM_M_TPQ_ENGLISH_ABC:
    case GUIIM_M_TPQ_ENGLISH_ABC_LOWER:
    case GUIIM_M_TPQ_ENGLISH_ABC_LEAD_UPPER:
    case GUIIM_M_TPQ_ENGLISH_ABC_UPPER:
        is_init = QwertAbcInit(data_ptr);
        break;

    case GUIIM_M_TPQ_ENGLISH:
    case GUIIM_M_TPQ_ENGLISH_LOWER:
    case GUIIM_M_TPQ_ENGLISH_LEAD_UPPER:
    case GUIIM_M_TPQ_ENGLISH_UPPER:
        is_init = QwertLatinInit(data_ptr);
        break;

        //ESTONIAN
#ifdef IM_ESTONIAN_SUPPORT
    case GUIIM_M_TP_ESTONIAN:
    case GUIIM_M_TP_ESTONIAN_LEAD_UPPER:
    case GUIIM_M_TP_ESTONIAN_LOWER:
    case GUIIM_M_TP_ESTONIAN_UPPER:
        {
            is_init = ThumbSmartInit(data_ptr);
            break;
        }

    case GUIIM_M_TPQ_ESTONIAN:
    case GUIIM_M_TPQ_ESTONIAN_LEAD_UPPER:
    case GUIIM_M_TPQ_ESTONIAN_LOWER:
    case GUIIM_M_TPQ_ESTONIAN_UPPER:
        {
            is_init = QwertSmartInit(data_ptr);
            break;
        }

    case GUIIM_M_TP_ESTONIAN_ABC:
    case GUIIM_M_TP_ESTONIAN_ABC_LEAD_UPPER:
    case GUIIM_M_TP_ESTONIAN_ABC_LOWER:
    case GUIIM_M_TP_ESTONIAN_ABC_UPPER:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_ESTONIAN_ABC:
    case GUIIM_M_TPQ_ESTONIAN_ABC_LEAD_UPPER:
    case GUIIM_M_TPQ_ESTONIAN_ABC_LOWER:
    case GUIIM_M_TPQ_ESTONIAN_ABC_UPPER:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //FILIPINO
#ifdef IM_FILIPINO_SUPPORT
    case GUIIM_M_TP_FILIPINO:
    case GUIIM_M_TP_FILIPINO_LEAD_UPPER:
    case GUIIM_M_TP_FILIPINO_LOWER:
    case GUIIM_M_TP_FILIPINO_UPPER:
        {
            is_init = ThumbSmartInit(data_ptr);
            break;
        }

    case GUIIM_M_TPQ_FILIPINO:
    case GUIIM_M_TPQ_FILIPINO_LEAD_UPPER:
    case GUIIM_M_TPQ_FILIPINO_LOWER:
    case GUIIM_M_TPQ_FILIPINO_UPPER:
        {
            is_init = QwertSmartInit(data_ptr);
            break;
        }

    case GUIIM_M_TP_FILIPINO_ABC:
    case GUIIM_M_TP_FILIPINO_ABC_LEAD_UPPER:
    case GUIIM_M_TP_FILIPINO_ABC_LOWER:
    case GUIIM_M_TP_FILIPINO_ABC_UPPER:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_FILIPINO_ABC:
    case GUIIM_M_TPQ_FILIPINO_ABC_LEAD_UPPER:
    case GUIIM_M_TPQ_FILIPINO_ABC_LOWER:
    case GUIIM_M_TPQ_FILIPINO_ABC_UPPER:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //FINNISH
#ifdef IM_FINNISH_SUPPORT
    case GUIIM_M_TP_FINNISH:
    case GUIIM_M_TP_FINNISH_LEAD_UPPER:
    case GUIIM_M_TP_FINNISH_LOWER:
    case GUIIM_M_TP_FINNISH_UPPER:
        {
            is_init = ThumbSmartInit(data_ptr);
            break;
        }

    case GUIIM_M_TPQ_FINNISH:
    case GUIIM_M_TPQ_FINNISH_LEAD_UPPER:
    case GUIIM_M_TPQ_FINNISH_LOWER:
    case GUIIM_M_TPQ_FINNISH_UPPER:
        {
            is_init = QwertSmartInit(data_ptr);
            break;
        }

    case GUIIM_M_TP_FINNISH_ABC:
    case GUIIM_M_TP_FINNISH_ABC_LEAD_UPPER:
    case GUIIM_M_TP_FINNISH_ABC_LOWER:
    case GUIIM_M_TP_FINNISH_ABC_UPPER:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_FINNISH_ABC:
    case GUIIM_M_TPQ_FINNISH_ABC_LEAD_UPPER:
    case GUIIM_M_TPQ_FINNISH_ABC_LOWER:
    case GUIIM_M_TPQ_FINNISH_ABC_UPPER:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //french 法语
#if defined (IM_FRENCH_SUPPORT)
    case GUIIM_M_TP_FRENCH:
    case GUIIM_M_TP_FRENCH_LEAD_UPPER:
    case GUIIM_M_TP_FRENCH_LOWER:
    case GUIIM_M_TP_FRENCH_UPPER:
        is_init = ThumbSmartInit(data_ptr);
        break;

    case GUIIM_M_TPQ_FRENCH:
    case GUIIM_M_TPQ_FRENCH_LEAD_UPPER:
    case GUIIM_M_TPQ_FRENCH_LOWER:
    case GUIIM_M_TPQ_FRENCH_UPPER:
        is_init = QwertSmartInit(data_ptr);
        break;

    case GUIIM_M_TP_FRENCH_ABC:
    case GUIIM_M_TP_FRENCH_ABC_LEAD_UPPER:
    case GUIIM_M_TP_FRENCH_ABC_LOWER:
    case GUIIM_M_TP_FRENCH_ABC_UPPER:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_FRENCH_ABC:
    case GUIIM_M_TPQ_FRENCH_ABC_LEAD_UPPER:
    case GUIIM_M_TPQ_FRENCH_ABC_LOWER:
    case GUIIM_M_TPQ_FRENCH_ABC_UPPER:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //GALICIAN
#if defined (IM_GALICIAN_SUPPORT)
    case GUIIM_M_TP_GALICIAN:
    case GUIIM_M_TP_GALICIAN_LEAD_UPPER:
    case GUIIM_M_TP_GALICIAN_LOWER:
    case GUIIM_M_TP_GALICIAN_UPPER:
        is_init = ThumbSmartInit(data_ptr);
        break;

    case GUIIM_M_TPQ_GALICIAN:
    case GUIIM_M_TPQ_GALICIAN_LEAD_UPPER:
    case GUIIM_M_TPQ_GALICIAN_LOWER:
    case GUIIM_M_TPQ_GALICIAN_UPPER:
        is_init = QwertSmartInit(data_ptr);
        break;

    case GUIIM_M_TP_GALICIAN_ABC:
    case GUIIM_M_TP_GALICIAN_ABC_LEAD_UPPER:
    case GUIIM_M_TP_GALICIAN_ABC_LOWER:
    case GUIIM_M_TP_GALICIAN_ABC_UPPER:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_GALICIAN_ABC:
    case GUIIM_M_TPQ_GALICIAN_ABC_LEAD_UPPER:
    case GUIIM_M_TPQ_GALICIAN_ABC_LOWER:
    case GUIIM_M_TPQ_GALICIAN_ABC_UPPER:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //德语
#ifdef IM_GERMAN_SUPPORT
    case GUIIM_M_TP_GERMAN:
    case GUIIM_M_TP_GERMAN_LEAD_UPPER:
    case GUIIM_M_TP_GERMAN_LOWER:
    case GUIIM_M_TP_GERMAN_UPPER:
        {
            is_init = ThumbSmartInit(data_ptr);
            break;
        }

    case GUIIM_M_TPQ_GERMAN:
    case GUIIM_M_TPQ_GERMAN_LEAD_UPPER:
    case GUIIM_M_TPQ_GERMAN_LOWER:
    case GUIIM_M_TPQ_GERMAN_UPPER:
        {
            is_init = QwertSmartInit(data_ptr);
            break;
        }
    case GUIIM_M_TP_GERMAN_ABC:
    case GUIIM_M_TP_GERMAN_ABC_LEAD_UPPER:
    case GUIIM_M_TP_GERMAN_ABC_LOWER:
    case GUIIM_M_TP_GERMAN_ABC_UPPER:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_GERMAN_ABC:
    case GUIIM_M_TPQ_GERMAN_ABC_LEAD_UPPER:
    case GUIIM_M_TPQ_GERMAN_ABC_LOWER:
    case GUIIM_M_TPQ_GERMAN_ABC_UPPER:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //GREEK
#ifdef IM_GREEK_SUPPORT
    case GUIIM_M_TP_GREEK:
    case GUIIM_M_TP_GREEK_LEAD_UPPER:
    case GUIIM_M_TP_GREEK_LOWER:
    case GUIIM_M_TP_GREEK_UPPER:
        {
            is_init = ThumbSmartInit(data_ptr);
            break;
        }

    case GUIIM_M_TPQ_GREEK:
    case GUIIM_M_TPQ_GREEK_LEAD_UPPER:
    case GUIIM_M_TPQ_GREEK_LOWER:
    case GUIIM_M_TPQ_GREEK_UPPER:
        {
            is_init = QwertSmartInit(data_ptr);
            break;
        }
    case GUIIM_M_TP_GREEK_ABC:
    case GUIIM_M_TP_GREEK_ABC_LEAD_UPPER:
    case GUIIM_M_TP_GREEK_ABC_LOWER:
    case GUIIM_M_TP_GREEK_ABC_UPPER:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_GREEK_ABC:
    case GUIIM_M_TPQ_GREEK_ABC_LEAD_UPPER:
    case GUIIM_M_TPQ_GREEK_ABC_LOWER:
    case GUIIM_M_TPQ_GREEK_ABC_UPPER:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //HAUSA
#ifdef IM_HAUSA_SUPPORT
    case GUIIM_M_TP_HAUSA:
    case GUIIM_M_TP_HAUSA_LEAD_UPPER:
    case GUIIM_M_TP_HAUSA_LOWER:
    case GUIIM_M_TP_HAUSA_UPPER:
        {
            is_init = ThumbSmartInit(data_ptr);
            break;
        }

    case GUIIM_M_TPQ_HAUSA:
    case GUIIM_M_TPQ_HAUSA_LEAD_UPPER:
    case GUIIM_M_TPQ_HAUSA_LOWER:
    case GUIIM_M_TPQ_HAUSA_UPPER:
        {
            is_init = QwertSmartInit(data_ptr);
            break;
        }
    case GUIIM_M_TP_HAUSA_ABC:
    case GUIIM_M_TP_HAUSA_ABC_LEAD_UPPER:
    case GUIIM_M_TP_HAUSA_ABC_LOWER:
    case GUIIM_M_TP_HAUSA_ABC_UPPER:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_HAUSA_ABC:
    case GUIIM_M_TPQ_HAUSA_ABC_LEAD_UPPER:
    case GUIIM_M_TPQ_HAUSA_ABC_LOWER:
    case GUIIM_M_TPQ_HAUSA_ABC_UPPER:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //HUNGARIAN 匈牙利
#if defined (IM_HUNGARIAN_SUPPORT)
    case GUIIM_M_TP_HUNGARIAN:
    case GUIIM_M_TP_HUNGARIAN_LEAD_UPPER:
    case GUIIM_M_TP_HUNGARIAN_LOWER:
    case GUIIM_M_TP_HUNGARIAN_UPPER:
        is_init = ThumbSmartInit(data_ptr);
        break;

    case GUIIM_M_TPQ_HUNGARIAN:
    case GUIIM_M_TPQ_HUNGARIAN_LEAD_UPPER:
    case GUIIM_M_TPQ_HUNGARIAN_LOWER:
    case GUIIM_M_TPQ_HUNGARIAN_UPPER:
        is_init = QwertSmartInit(data_ptr);
        break;

    case GUIIM_M_TP_HUNGARIAN_ABC:
    case GUIIM_M_TP_HUNGARIAN_ABC_LEAD_UPPER:
    case GUIIM_M_TP_HUNGARIAN_ABC_LOWER:
    case GUIIM_M_TP_HUNGARIAN_ABC_UPPER:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_HUNGARIAN_ABC:
    case GUIIM_M_TPQ_HUNGARIAN_ABC_LEAD_UPPER:
    case GUIIM_M_TPQ_HUNGARIAN_ABC_LOWER:
    case GUIIM_M_TPQ_HUNGARIAN_ABC_UPPER:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //ICELANDIC
#ifdef IM_ICELANDIC_SUPPORT
    case GUIIM_M_TP_ICELANDIC:
    case GUIIM_M_TP_ICELANDIC_LEAD_UPPER:
    case GUIIM_M_TP_ICELANDIC_LOWER:
    case GUIIM_M_TP_ICELANDIC_UPPER:
        {
            is_init = ThumbSmartInit(data_ptr);
            break;
        }

    case GUIIM_M_TPQ_ICELANDIC:
    case GUIIM_M_TPQ_ICELANDIC_LEAD_UPPER:
    case GUIIM_M_TPQ_ICELANDIC_LOWER:
    case GUIIM_M_TPQ_ICELANDIC_UPPER:
        {
            is_init = QwertSmartInit(data_ptr);
            break;
        }
    case GUIIM_M_TP_ICELANDIC_ABC:
    case GUIIM_M_TP_ICELANDIC_ABC_LEAD_UPPER:
    case GUIIM_M_TP_ICELANDIC_ABC_LOWER:
    case GUIIM_M_TP_ICELANDIC_ABC_UPPER:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_ICELANDIC_ABC:
    case GUIIM_M_TPQ_ICELANDIC_ABC_LEAD_UPPER:
    case GUIIM_M_TPQ_ICELANDIC_ABC_LOWER:
    case GUIIM_M_TPQ_ICELANDIC_ABC_UPPER:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //IGBO
#ifdef IM_IGBO_SUPPORT
    case GUIIM_M_TP_IGBO:
    case GUIIM_M_TP_IGBO_LEAD_UPPER:
    case GUIIM_M_TP_IGBO_LOWER:
    case GUIIM_M_TP_IGBO_UPPER:
        {
            is_init = ThumbSmartInit(data_ptr);
            break;
        }

    case GUIIM_M_TPQ_IGBO:
    case GUIIM_M_TPQ_IGBO_LEAD_UPPER:
    case GUIIM_M_TPQ_IGBO_LOWER:
    case GUIIM_M_TPQ_IGBO_UPPER:
        {
            is_init = QwertSmartInit(data_ptr);
            break;
        }
    case GUIIM_M_TP_IGBO_ABC:
    case GUIIM_M_TP_IGBO_ABC_LEAD_UPPER:
    case GUIIM_M_TP_IGBO_ABC_LOWER:
    case GUIIM_M_TP_IGBO_ABC_UPPER:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_IGBO_ABC:
    case GUIIM_M_TPQ_IGBO_ABC_LEAD_UPPER:
    case GUIIM_M_TPQ_IGBO_ABC_LOWER:
    case GUIIM_M_TPQ_IGBO_ABC_UPPER:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //印尼
#ifdef IM_INDONESIAN_SUPPORT
    case GUIIM_M_TP_INDONESIAN:
    case GUIIM_M_TP_INDONESIAN_LEAD_UPPER:
    case GUIIM_M_TP_INDONESIAN_LOWER:
    case GUIIM_M_TP_INDONESIAN_UPPER:
        {
            is_init = ThumbSmartInit(data_ptr);
            break;
        }

    case GUIIM_M_TPQ_INDONESIAN:
    case GUIIM_M_TPQ_INDONESIAN_LEAD_UPPER:
    case GUIIM_M_TPQ_INDONESIAN_LOWER:
    case GUIIM_M_TPQ_INDONESIAN_UPPER:
        {
            is_init = QwertSmartInit(data_ptr);
            break;
        }
    case GUIIM_M_TP_INDONESIAN_ABC:
    case GUIIM_M_TP_INDONESIAN_ABC_LEAD_UPPER:
    case GUIIM_M_TP_INDONESIAN_ABC_LOWER:
    case GUIIM_M_TP_INDONESIAN_ABC_UPPER:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_INDONESIAN_ABC:
    case GUIIM_M_TPQ_INDONESIAN_ABC_LEAD_UPPER:
    case GUIIM_M_TPQ_INDONESIAN_ABC_LOWER:
    case GUIIM_M_TPQ_INDONESIAN_ABC_UPPER:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //IRISH
#ifdef IM_IRISH_SUPPORT
    case GUIIM_M_TP_IRISH:
    case GUIIM_M_TP_IRISH_LEAD_UPPER:
    case GUIIM_M_TP_IRISH_LOWER:
    case GUIIM_M_TP_IRISH_UPPER:
        {
            is_init = ThumbSmartInit(data_ptr);
            break;
        }

    case GUIIM_M_TPQ_IRISH:
    case GUIIM_M_TPQ_IRISH_LEAD_UPPER:
    case GUIIM_M_TPQ_IRISH_LOWER:
    case GUIIM_M_TPQ_IRISH_UPPER:
        {
            is_init = QwertSmartInit(data_ptr);
            break;
        }
    case GUIIM_M_TP_IRISH_ABC:
    case GUIIM_M_TP_IRISH_ABC_LEAD_UPPER:
    case GUIIM_M_TP_IRISH_ABC_LOWER:
    case GUIIM_M_TP_IRISH_ABC_UPPER:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_IRISH_ABC:
    case GUIIM_M_TPQ_IRISH_ABC_LEAD_UPPER:
    case GUIIM_M_TPQ_IRISH_ABC_LOWER:
    case GUIIM_M_TPQ_IRISH_ABC_UPPER:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //ITALIAN 意大利
#if defined (IM_ITALIAN_SUPPORT)
    case GUIIM_M_TP_ITALIAN:
    case GUIIM_M_TP_ITALIAN_LEAD_UPPER:
    case GUIIM_M_TP_ITALIAN_LOWER:
    case GUIIM_M_TP_ITALIAN_UPPER:
        is_init = ThumbSmartInit(data_ptr);
        break;

    case GUIIM_M_TPQ_ITALIAN:
    case GUIIM_M_TPQ_ITALIAN_LEAD_UPPER:
    case GUIIM_M_TPQ_ITALIAN_LOWER:
    case GUIIM_M_TPQ_ITALIAN_UPPER:
        is_init = QwertSmartInit(data_ptr);
        break;
    case GUIIM_M_TP_ITALIAN_ABC:
    case GUIIM_M_TP_ITALIAN_ABC_LEAD_UPPER:
    case GUIIM_M_TP_ITALIAN_ABC_LOWER:
    case GUIIM_M_TP_ITALIAN_ABC_UPPER:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_ITALIAN_ABC:
    case GUIIM_M_TPQ_ITALIAN_ABC_LEAD_UPPER:
    case GUIIM_M_TPQ_ITALIAN_ABC_LOWER:
    case GUIIM_M_TPQ_ITALIAN_ABC_UPPER:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //KAZAKH
#ifdef IM_KAZAKH_SUPPORT
    case GUIIM_M_TP_KAZAKH:
    case GUIIM_M_TP_KAZAKH_LEAD_UPPER:
    case GUIIM_M_TP_KAZAKH_LOWER:
    case GUIIM_M_TP_KAZAKH_UPPER:
        {
            is_init = ThumbSmartInit(data_ptr);
            break;
        }

    case GUIIM_M_TPQ_KAZAKH:
    case GUIIM_M_TPQ_KAZAKH_LEAD_UPPER:
    case GUIIM_M_TPQ_KAZAKH_LOWER:
    case GUIIM_M_TPQ_KAZAKH_UPPER:
        {
            is_init = QwertSmartInit(data_ptr);
            break;
        }
    case GUIIM_M_TP_KAZAKH_ABC:
    case GUIIM_M_TP_KAZAKH_ABC_LEAD_UPPER:
    case GUIIM_M_TP_KAZAKH_ABC_LOWER:
    case GUIIM_M_TP_KAZAKH_ABC_UPPER:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_KAZAKH_ABC:
    case GUIIM_M_TPQ_KAZAKH_ABC_LEAD_UPPER:
    case GUIIM_M_TPQ_KAZAKH_ABC_LOWER:
    case GUIIM_M_TPQ_KAZAKH_ABC_UPPER:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //LATVIAN
#ifdef IM_LATVIAN_SUPPORT
    case GUIIM_M_TP_LATVIAN:
    case GUIIM_M_TP_LATVIAN_LEAD_UPPER:
    case GUIIM_M_TP_LATVIAN_LOWER:
    case GUIIM_M_TP_LATVIAN_UPPER:
        {
            is_init = ThumbSmartInit(data_ptr);
            break;
        }

    case GUIIM_M_TPQ_LATVIAN:
    case GUIIM_M_TPQ_LATVIAN_LEAD_UPPER:
    case GUIIM_M_TPQ_LATVIAN_LOWER:
    case GUIIM_M_TPQ_LATVIAN_UPPER:
        {
            is_init = QwertSmartInit(data_ptr);
            break;
        }
    case GUIIM_M_TP_LATVIAN_ABC:
    case GUIIM_M_TP_LATVIAN_ABC_LEAD_UPPER:
    case GUIIM_M_TP_LATVIAN_ABC_LOWER:
    case GUIIM_M_TP_LATVIAN_ABC_UPPER:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_LATVIAN_ABC:
    case GUIIM_M_TPQ_LATVIAN_ABC_LEAD_UPPER:
    case GUIIM_M_TPQ_LATVIAN_ABC_LOWER:
    case GUIIM_M_TPQ_LATVIAN_ABC_UPPER:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //LITHUANIAN
#ifdef IM_LITHUANIAN_SUPPORT
    case GUIIM_M_TP_LITHUANIAN:
    case GUIIM_M_TP_LITHUANIAN_LEAD_UPPER:
    case GUIIM_M_TP_LITHUANIAN_LOWER:
    case GUIIM_M_TP_LITHUANIAN_UPPER:
        {
            is_init = ThumbSmartInit(data_ptr);
            break;
        }

    case GUIIM_M_TPQ_LITHUANIAN:
    case GUIIM_M_TPQ_LITHUANIAN_LEAD_UPPER:
    case GUIIM_M_TPQ_LITHUANIAN_LOWER:
    case GUIIM_M_TPQ_LITHUANIAN_UPPER:
        {
            is_init = QwertSmartInit(data_ptr);
            break;
        }
    case GUIIM_M_TP_LITHUANIAN_ABC:
    case GUIIM_M_TP_LITHUANIAN_ABC_LEAD_UPPER:
    case GUIIM_M_TP_LITHUANIAN_ABC_LOWER:
    case GUIIM_M_TP_LITHUANIAN_ABC_UPPER:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_LITHUANIAN_ABC:
    case GUIIM_M_TPQ_LITHUANIAN_ABC_LEAD_UPPER:
    case GUIIM_M_TPQ_LITHUANIAN_ABC_LOWER:
    case GUIIM_M_TPQ_LITHUANIAN_ABC_UPPER:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //MACEDONIAN
#ifdef IM_MACEDONIAN_SUPPORT
    case GUIIM_M_TP_MACEDONIAN:
    case GUIIM_M_TP_MACEDONIAN_LEAD_UPPER:
    case GUIIM_M_TP_MACEDONIAN_LOWER:
    case GUIIM_M_TP_MACEDONIAN_UPPER:
        {
            is_init = ThumbSmartInit(data_ptr);
            break;
        }

    case GUIIM_M_TPQ_MACEDONIAN:
    case GUIIM_M_TPQ_MACEDONIAN_LEAD_UPPER:
    case GUIIM_M_TPQ_MACEDONIAN_LOWER:
    case GUIIM_M_TPQ_MACEDONIAN_UPPER:
        {
            is_init = QwertSmartInit(data_ptr);
            break;
        }
    case GUIIM_M_TP_MACEDONIAN_ABC:
    case GUIIM_M_TP_MACEDONIAN_ABC_LEAD_UPPER:
    case GUIIM_M_TP_MACEDONIAN_ABC_LOWER:
    case GUIIM_M_TP_MACEDONIAN_ABC_UPPER:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_MACEDONIAN_ABC:
    case GUIIM_M_TPQ_MACEDONIAN_ABC_LEAD_UPPER:
    case GUIIM_M_TPQ_MACEDONIAN_ABC_LOWER:
    case GUIIM_M_TPQ_MACEDONIAN_ABC_UPPER:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //MALAY //马来西亚
#ifdef IM_MALAY_SUPPORT
    case GUIIM_M_TP_MALAY:
    case GUIIM_M_TP_MALAY_LEAD_UPPER:
    case GUIIM_M_TP_MALAY_LOWER:
    case GUIIM_M_TP_MALAY_UPPER:
        {
            is_init = ThumbSmartInit(data_ptr);
            break;
        }

    case GUIIM_M_TPQ_MALAY:
    case GUIIM_M_TPQ_MALAY_LEAD_UPPER:
    case GUIIM_M_TPQ_MALAY_LOWER:
    case GUIIM_M_TPQ_MALAY_UPPER:
        {
            is_init = QwertSmartInit(data_ptr);
            break;
        }
    case GUIIM_M_TP_MALAY_ABC:
    case GUIIM_M_TP_MALAY_ABC_LEAD_UPPER:
    case GUIIM_M_TP_MALAY_ABC_LOWER:
    case GUIIM_M_TP_MALAY_ABC_UPPER:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_MALAY_ABC:
    case GUIIM_M_TPQ_MALAY_ABC_LEAD_UPPER:
    case GUIIM_M_TPQ_MALAY_ABC_LOWER:
    case GUIIM_M_TPQ_MALAY_ABC_UPPER:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //MOLDOVAN
#ifdef IM_MOLDOVAN_SUPPORT
    case GUIIM_M_TP_MOLDOVAN:
    case GUIIM_M_TP_MOLDOVAN_LEAD_UPPER:
    case GUIIM_M_TP_MOLDOVAN_LOWER:
    case GUIIM_M_TP_MOLDOVAN_UPPER:
        {
            is_init = ThumbSmartInit(data_ptr);
            break;
        }

    case GUIIM_M_TPQ_MOLDOVAN:
    case GUIIM_M_TPQ_MOLDOVAN_LEAD_UPPER:
    case GUIIM_M_TPQ_MOLDOVAN_LOWER:
    case GUIIM_M_TPQ_MOLDOVAN_UPPER:
        {
            is_init = QwertSmartInit(data_ptr);
            break;
        }
    case GUIIM_M_TP_MOLDOVAN_ABC:
    case GUIIM_M_TP_MOLDOVAN_ABC_LEAD_UPPER:
    case GUIIM_M_TP_MOLDOVAN_ABC_LOWER:
    case GUIIM_M_TP_MOLDOVAN_ABC_UPPER:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_MOLDOVAN_ABC:
    case GUIIM_M_TPQ_MOLDOVAN_ABC_LEAD_UPPER:
    case GUIIM_M_TPQ_MOLDOVAN_ABC_LOWER:
    case GUIIM_M_TPQ_MOLDOVAN_ABC_UPPER:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //NORWEGIAN
#ifdef IM_NORWEGIAN_SUPPORT
    case GUIIM_M_TP_NORWEGIAN:
    case GUIIM_M_TP_NORWEGIAN_LEAD_UPPER:
    case GUIIM_M_TP_NORWEGIAN_LOWER:
    case GUIIM_M_TP_NORWEGIAN_UPPER:
        {
            is_init = ThumbSmartInit(data_ptr);
            break;
        }

    case GUIIM_M_TPQ_NORWEGIAN:
    case GUIIM_M_TPQ_NORWEGIAN_LEAD_UPPER:
    case GUIIM_M_TPQ_NORWEGIAN_LOWER:
    case GUIIM_M_TPQ_NORWEGIAN_UPPER:
        {
            is_init = QwertSmartInit(data_ptr);
            break;
        }
    case GUIIM_M_TP_NORWEGIAN_ABC:
    case GUIIM_M_TP_NORWEGIAN_ABC_LEAD_UPPER:
    case GUIIM_M_TP_NORWEGIAN_ABC_LOWER:
    case GUIIM_M_TP_NORWEGIAN_ABC_UPPER:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_NORWEGIAN_ABC:
    case GUIIM_M_TPQ_NORWEGIAN_ABC_LEAD_UPPER:
    case GUIIM_M_TPQ_NORWEGIAN_ABC_LOWER:
    case GUIIM_M_TPQ_NORWEGIAN_ABC_UPPER:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //POLISH
#ifdef IM_POLISH_SUPPORT
    case GUIIM_M_TP_POLISH:
    case GUIIM_M_TP_POLISH_LEAD_UPPER:
    case GUIIM_M_TP_POLISH_LOWER:
    case GUIIM_M_TP_POLISH_UPPER:
        {
            is_init = ThumbSmartInit(data_ptr);
            break;
        }

    case GUIIM_M_TPQ_POLISH:
    case GUIIM_M_TPQ_POLISH_LEAD_UPPER:
    case GUIIM_M_TPQ_POLISH_LOWER:
    case GUIIM_M_TPQ_POLISH_UPPER:
        {
            is_init = QwertSmartInit(data_ptr);
            break;
        }
    case GUIIM_M_TP_POLISH_ABC:
    case GUIIM_M_TP_POLISH_ABC_LEAD_UPPER:
    case GUIIM_M_TP_POLISH_ABC_LOWER:
    case GUIIM_M_TP_POLISH_ABC_UPPER:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_POLISH_ABC:
    case GUIIM_M_TPQ_POLISH_ABC_LEAD_UPPER:
    case GUIIM_M_TPQ_POLISH_ABC_LOWER:
    case GUIIM_M_TPQ_POLISH_ABC_UPPER:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //PORTUGUESE 葡萄牙
#if defined (IM_PORTUGUESE_SUPPORT)
    case GUIIM_M_TP_PORTUGUESE:
    case GUIIM_M_TP_PORTUGUESE_LEAD_UPPER:
    case GUIIM_M_TP_PORTUGUESE_LOWER:
    case GUIIM_M_TP_PORTUGUESE_UPPER:
        is_init = ThumbSmartInit(data_ptr);
        break;

    case GUIIM_M_TPQ_PORTUGUESE:
    case GUIIM_M_TPQ_PORTUGUESE_LEAD_UPPER:
    case GUIIM_M_TPQ_PORTUGUESE_LOWER:
    case GUIIM_M_TPQ_PORTUGUESE_UPPER:
        is_init = QwertSmartInit(data_ptr);
        break;

    case GUIIM_M_TP_PORTUGUESE_ABC:
    case GUIIM_M_TP_PORTUGUESE_ABC_LEAD_UPPER:
    case GUIIM_M_TP_PORTUGUESE_ABC_LOWER:
    case GUIIM_M_TP_PORTUGUESE_ABC_UPPER:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_PORTUGUESE_ABC:
    case GUIIM_M_TPQ_PORTUGUESE_ABC_LEAD_UPPER:
    case GUIIM_M_TPQ_PORTUGUESE_ABC_LOWER:
    case GUIIM_M_TPQ_PORTUGUESE_ABC_UPPER:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //ROMANIAN
#ifdef IM_ROMANIAN_SUPPORT
    case GUIIM_M_TP_ROMANIAN:
    case GUIIM_M_TP_ROMANIAN_LEAD_UPPER:
    case GUIIM_M_TP_ROMANIAN_LOWER:
    case GUIIM_M_TP_ROMANIAN_UPPER:
        {
            is_init = ThumbSmartInit(data_ptr);
            break;
        }

    case GUIIM_M_TPQ_ROMANIAN:
    case GUIIM_M_TPQ_ROMANIAN_LEAD_UPPER:
    case GUIIM_M_TPQ_ROMANIAN_LOWER:
    case GUIIM_M_TPQ_ROMANIAN_UPPER:
        {
            is_init = QwertSmartInit(data_ptr);
            break;
        }
    case GUIIM_M_TP_ROMANIAN_ABC:
    case GUIIM_M_TP_ROMANIAN_ABC_LEAD_UPPER:
    case GUIIM_M_TP_ROMANIAN_ABC_LOWER:
    case GUIIM_M_TP_ROMANIAN_ABC_UPPER:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_ROMANIAN_ABC:
    case GUIIM_M_TPQ_ROMANIAN_ABC_LEAD_UPPER:
    case GUIIM_M_TPQ_ROMANIAN_ABC_LOWER:
    case GUIIM_M_TPQ_ROMANIAN_ABC_UPPER:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //RUSSIAN 俄语
#if defined (IM_RUSSIAN_SUPPORT)
    case GUIIM_M_TP_RUSSIAN:
    case GUIIM_M_TP_RUSSIAN_LEAD_UPPER:
    case GUIIM_M_TP_RUSSIAN_LOWER:
    case GUIIM_M_TP_RUSSIAN_UPPER:
        is_init = ThumbSmartInit(data_ptr);
        break;

    case GUIIM_M_TPQ_RUSSIAN:
    case GUIIM_M_TPQ_RUSSIAN_LEAD_UPPER:
    case GUIIM_M_TPQ_RUSSIAN_LOWER:
    case GUIIM_M_TPQ_RUSSIAN_UPPER:
        is_init = QwertSmartInit(data_ptr);
        break;
    case GUIIM_M_TP_RUSSIAN_ABC:
    case GUIIM_M_TP_RUSSIAN_ABC_LEAD_UPPER:
    case GUIIM_M_TP_RUSSIAN_ABC_LOWER:
    case GUIIM_M_TP_RUSSIAN_ABC_UPPER:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_RUSSIAN_ABC:
    case GUIIM_M_TPQ_RUSSIAN_ABC_LEAD_UPPER:
    case GUIIM_M_TPQ_RUSSIAN_ABC_LOWER:
    case GUIIM_M_TPQ_RUSSIAN_ABC_UPPER:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //SERBIAN
#if defined (IM_SERBIAN_SUPPORT)
    case GUIIM_M_TP_SERBIAN:
    case GUIIM_M_TP_SERBIAN_LEAD_UPPER:
    case GUIIM_M_TP_SERBIAN_LOWER:
    case GUIIM_M_TP_SERBIAN_UPPER:
        is_init = ThumbSmartInit(data_ptr);
        break;

    case GUIIM_M_TPQ_SERBIAN:
    case GUIIM_M_TPQ_SERBIAN_LEAD_UPPER:
    case GUIIM_M_TPQ_SERBIAN_LOWER:
    case GUIIM_M_TPQ_SERBIAN_UPPER:
        is_init = QwertSmartInit(data_ptr);
        break;
    case GUIIM_M_TP_SERBIAN_ABC:
    case GUIIM_M_TP_SERBIAN_ABC_LEAD_UPPER:
    case GUIIM_M_TP_SERBIAN_ABC_LOWER:
    case GUIIM_M_TP_SERBIAN_ABC_UPPER:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_SERBIAN_ABC:
    case GUIIM_M_TPQ_SERBIAN_ABC_LEAD_UPPER:
    case GUIIM_M_TPQ_SERBIAN_ABC_LOWER:
    case GUIIM_M_TPQ_SERBIAN_ABC_UPPER:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //SESOTHO
#if defined (IM_SESOTHO_SUPPORT)
    case GUIIM_M_TP_SESOTHO:
    case GUIIM_M_TP_SESOTHO_LEAD_UPPER:
    case GUIIM_M_TP_SESOTHO_LOWER:
    case GUIIM_M_TP_SESOTHO_UPPER:
        is_init = ThumbSmartInit(data_ptr);
        break;

    case GUIIM_M_TPQ_SESOTHO:
    case GUIIM_M_TPQ_SESOTHO_LEAD_UPPER:
    case GUIIM_M_TPQ_SESOTHO_LOWER:
    case GUIIM_M_TPQ_SESOTHO_UPPER:
        is_init = QwertSmartInit(data_ptr);
        break;
    case GUIIM_M_TP_SESOTHO_ABC:
    case GUIIM_M_TP_SESOTHO_ABC_LEAD_UPPER:
    case GUIIM_M_TP_SESOTHO_ABC_LOWER:
    case GUIIM_M_TP_SESOTHO_ABC_UPPER:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_SESOTHO_ABC:
    case GUIIM_M_TPQ_SESOTHO_ABC_LEAD_UPPER:
    case GUIIM_M_TPQ_SESOTHO_ABC_LOWER:
    case GUIIM_M_TPQ_SESOTHO_ABC_UPPER:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //SLOVAK
#if defined (IM_SLOVAK_SUPPORT)
    case GUIIM_M_TP_SLOVAK:
    case GUIIM_M_TP_SLOVAK_LEAD_UPPER:
    case GUIIM_M_TP_SLOVAK_LOWER:
    case GUIIM_M_TP_SLOVAK_UPPER:
        is_init = ThumbSmartInit(data_ptr);
        break;

    case GUIIM_M_TPQ_SLOVAK:
    case GUIIM_M_TPQ_SLOVAK_LEAD_UPPER:
    case GUIIM_M_TPQ_SLOVAK_LOWER:
    case GUIIM_M_TPQ_SLOVAK_UPPER:
        is_init = QwertSmartInit(data_ptr);
        break;
    case GUIIM_M_TP_SLOVAK_ABC:
    case GUIIM_M_TP_SLOVAK_ABC_LEAD_UPPER:
    case GUIIM_M_TP_SLOVAK_ABC_LOWER:
    case GUIIM_M_TP_SLOVAK_ABC_UPPER:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_SLOVAK_ABC:
    case GUIIM_M_TPQ_SLOVAK_ABC_LEAD_UPPER:
    case GUIIM_M_TPQ_SLOVAK_ABC_LOWER:
    case GUIIM_M_TPQ_SLOVAK_ABC_UPPER:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //SLOVENIAN
#if defined (IM_SLOVENIAN_SUPPORT)
    case GUIIM_M_TP_SLOVENIAN:
    case GUIIM_M_TP_SLOVENIAN_LEAD_UPPER:
    case GUIIM_M_TP_SLOVENIAN_LOWER:
    case GUIIM_M_TP_SLOVENIAN_UPPER:
        is_init = ThumbSmartInit(data_ptr);
        break;

    case GUIIM_M_TPQ_SLOVENIAN:
    case GUIIM_M_TPQ_SLOVENIAN_LEAD_UPPER:
    case GUIIM_M_TPQ_SLOVENIAN_LOWER:
    case GUIIM_M_TPQ_SLOVENIAN_UPPER:
        is_init = QwertSmartInit(data_ptr);
        break;
    case GUIIM_M_TP_SLOVENIAN_ABC:
    case GUIIM_M_TP_SLOVENIAN_ABC_LEAD_UPPER:
    case GUIIM_M_TP_SLOVENIAN_ABC_LOWER:
    case GUIIM_M_TP_SLOVENIAN_ABC_UPPER:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_SLOVENIAN_ABC:
    case GUIIM_M_TPQ_SLOVENIAN_ABC_LEAD_UPPER:
    case GUIIM_M_TPQ_SLOVENIAN_ABC_LOWER:
    case GUIIM_M_TPQ_SLOVENIAN_ABC_UPPER:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //SPANISH 西班牙
#if defined (IM_SPANISH_SUPPORT)
    case GUIIM_M_TP_SPANISH:
    case GUIIM_M_TP_SPANISH_LEAD_UPPER:
    case GUIIM_M_TP_SPANISH_LOWER:
    case GUIIM_M_TP_SPANISH_UPPER:
        is_init = ThumbSmartInit(data_ptr);
        break;

    case GUIIM_M_TPQ_SPANISH:
    case GUIIM_M_TPQ_SPANISH_LEAD_UPPER:
    case GUIIM_M_TPQ_SPANISH_LOWER:
    case GUIIM_M_TPQ_SPANISH_UPPER:
        is_init = QwertSmartInit(data_ptr);
        break;

    case GUIIM_M_TP_SPANISH_ABC:
    case GUIIM_M_TP_SPANISH_ABC_LEAD_UPPER:
    case GUIIM_M_TP_SPANISH_ABC_LOWER:
    case GUIIM_M_TP_SPANISH_ABC_UPPER:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_SPANISH_ABC:
    case GUIIM_M_TPQ_SPANISH_ABC_LEAD_UPPER:
    case GUIIM_M_TPQ_SPANISH_ABC_LOWER:
    case GUIIM_M_TPQ_SPANISH_ABC_UPPER:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //SWAHILI
#if defined (IM_SWAHILI_SUPPORT)
    case GUIIM_M_TP_SWAHILI:
    case GUIIM_M_TP_SWAHILI_LEAD_UPPER:
    case GUIIM_M_TP_SWAHILI_LOWER:
    case GUIIM_M_TP_SWAHILI_UPPER:
        is_init = ThumbSmartInit(data_ptr);
        break;

    case GUIIM_M_TPQ_SWAHILI:
    case GUIIM_M_TPQ_SWAHILI_LEAD_UPPER:
    case GUIIM_M_TPQ_SWAHILI_LOWER:
    case GUIIM_M_TPQ_SWAHILI_UPPER:
        is_init = QwertSmartInit(data_ptr);
        break;
    case GUIIM_M_TP_SWAHILI_ABC:
    case GUIIM_M_TP_SWAHILI_ABC_LEAD_UPPER:
    case GUIIM_M_TP_SWAHILI_ABC_LOWER:
    case GUIIM_M_TP_SWAHILI_ABC_UPPER:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_SWAHILI_ABC:
    case GUIIM_M_TPQ_SWAHILI_ABC_LEAD_UPPER:
    case GUIIM_M_TPQ_SWAHILI_ABC_LOWER:
    case GUIIM_M_TPQ_SWAHILI_ABC_UPPER:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //SWEDISH
#if defined (IM_SWEDISH_SUPPORT)
    case GUIIM_M_TP_SWEDISH:
    case GUIIM_M_TP_SWEDISH_LEAD_UPPER:
    case GUIIM_M_TP_SWEDISH_LOWER:
    case GUIIM_M_TP_SWEDISH_UPPER:
        is_init = ThumbSmartInit(data_ptr);
        break;

    case GUIIM_M_TPQ_SWEDISH:
    case GUIIM_M_TPQ_SWEDISH_LEAD_UPPER:
    case GUIIM_M_TPQ_SWEDISH_LOWER:
    case GUIIM_M_TPQ_SWEDISH_UPPER:
        is_init = QwertSmartInit(data_ptr);
        break;
    case GUIIM_M_TP_SWEDISH_ABC:
    case GUIIM_M_TP_SWEDISH_ABC_LEAD_UPPER:
    case GUIIM_M_TP_SWEDISH_ABC_LOWER:
    case GUIIM_M_TP_SWEDISH_ABC_UPPER:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_SWEDISH_ABC:
    case GUIIM_M_TPQ_SWEDISH_ABC_LEAD_UPPER:
    case GUIIM_M_TPQ_SWEDISH_ABC_LOWER:
    case GUIIM_M_TPQ_SWEDISH_ABC_UPPER:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //TURKISH
#if defined (IM_TURKISH_SUPPORT)
    case GUIIM_M_TP_TURKISH:
    case GUIIM_M_TP_TURKISH_LEAD_UPPER:
    case GUIIM_M_TP_TURKISH_LOWER:
    case GUIIM_M_TP_TURKISH_UPPER:
        is_init = ThumbSmartInit(data_ptr);
        break;

    case GUIIM_M_TPQ_TURKISH:
    case GUIIM_M_TPQ_TURKISH_LEAD_UPPER:
    case GUIIM_M_TPQ_TURKISH_LOWER:
    case GUIIM_M_TPQ_TURKISH_UPPER:
        is_init = QwertSmartInit(data_ptr);
        break;
    case GUIIM_M_TP_TURKISH_ABC:
    case GUIIM_M_TP_TURKISH_ABC_LEAD_UPPER:
    case GUIIM_M_TP_TURKISH_ABC_LOWER:
    case GUIIM_M_TP_TURKISH_ABC_UPPER:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_TURKISH_ABC:
    case GUIIM_M_TPQ_TURKISH_ABC_LEAD_UPPER:
    case GUIIM_M_TPQ_TURKISH_ABC_LOWER:
    case GUIIM_M_TPQ_TURKISH_ABC_UPPER:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //UKRAINIAN
#if defined (IM_UKRAINIAN_SUPPORT)
    case GUIIM_M_TP_UKRAINIAN:
    case GUIIM_M_TP_UKRAINIAN_LEAD_UPPER:
    case GUIIM_M_TP_UKRAINIAN_LOWER:
    case GUIIM_M_TP_UKRAINIAN_UPPER:
        is_init = ThumbSmartInit(data_ptr);
        break;

    case GUIIM_M_TPQ_UKRAINIAN:
    case GUIIM_M_TPQ_UKRAINIAN_LEAD_UPPER:
    case GUIIM_M_TPQ_UKRAINIAN_LOWER:
    case GUIIM_M_TPQ_UKRAINIAN_UPPER:
        is_init = QwertSmartInit(data_ptr);
        break;
    case GUIIM_M_TP_UKRAINIAN_ABC:
    case GUIIM_M_TP_UKRAINIAN_ABC_LEAD_UPPER:
    case GUIIM_M_TP_UKRAINIAN_ABC_LOWER:
    case GUIIM_M_TP_UKRAINIAN_ABC_UPPER:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_UKRAINIAN_ABC:
    case GUIIM_M_TPQ_UKRAINIAN_ABC_LEAD_UPPER:
    case GUIIM_M_TPQ_UKRAINIAN_ABC_LOWER:
    case GUIIM_M_TPQ_UKRAINIAN_ABC_UPPER:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //越南
#ifdef IM_VIETNAMESE_SUPPORT
    case GUIIM_M_TP_VIETNAMESE:
    case GUIIM_M_TP_VIETNAMESE_LEAD_UPPER:
    case GUIIM_M_TP_VIETNAMESE_LOWER:
    case GUIIM_M_TP_VIETNAMESE_UPPER:
        {
            is_init = ThumbSmartInit(data_ptr);
            break;
        }

    case GUIIM_M_TPQ_VIETNAMESE:
    case GUIIM_M_TPQ_VIETNAMESE_LEAD_UPPER:
    case GUIIM_M_TPQ_VIETNAMESE_LOWER:
    case GUIIM_M_TPQ_VIETNAMESE_UPPER:
        {
            is_init = QwertSmartInit(data_ptr);
            break;
        }
    case GUIIM_M_TP_VIETNAMESE_ABC:
    case GUIIM_M_TP_VIETNAMESE_ABC_LEAD_UPPER:
    case GUIIM_M_TP_VIETNAMESE_ABC_LOWER:
    case GUIIM_M_TP_VIETNAMESE_ABC_UPPER:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_VIETNAMESE_ABC:
    case GUIIM_M_TPQ_VIETNAMESE_ABC_LEAD_UPPER:
    case GUIIM_M_TPQ_VIETNAMESE_ABC_LOWER:
    case GUIIM_M_TPQ_VIETNAMESE_ABC_UPPER:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //XHOSA
#if defined (IM_XHOSA_SUPPORT)
    case GUIIM_M_TP_XHOSA:
    case GUIIM_M_TP_XHOSA_LEAD_UPPER:
    case GUIIM_M_TP_XHOSA_LOWER:
    case GUIIM_M_TP_XHOSA_UPPER:
        is_init = ThumbSmartInit(data_ptr);
        break;

    case GUIIM_M_TPQ_XHOSA:
    case GUIIM_M_TPQ_XHOSA_LEAD_UPPER:
    case GUIIM_M_TPQ_XHOSA_LOWER:
    case GUIIM_M_TPQ_XHOSA_UPPER:
        is_init = QwertSmartInit(data_ptr);
        break;
    case GUIIM_M_TP_XHOSA_ABC:
    case GUIIM_M_TP_XHOSA_ABC_LEAD_UPPER:
    case GUIIM_M_TP_XHOSA_ABC_LOWER:
    case GUIIM_M_TP_XHOSA_ABC_UPPER:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_XHOSA_ABC:
    case GUIIM_M_TPQ_XHOSA_ABC_LEAD_UPPER:
    case GUIIM_M_TPQ_XHOSA_ABC_LOWER:
    case GUIIM_M_TPQ_XHOSA_ABC_UPPER:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //YORUBA
#if defined (IM_YORUBA_SUPPORT)
    case GUIIM_M_TP_YORUBA:
    case GUIIM_M_TP_YORUBA_LEAD_UPPER:
    case GUIIM_M_TP_YORUBA_LOWER:
    case GUIIM_M_TP_YORUBA_UPPER:
        is_init = ThumbSmartInit(data_ptr);
        break;

    case GUIIM_M_TPQ_YORUBA:
    case GUIIM_M_TPQ_YORUBA_LEAD_UPPER:
    case GUIIM_M_TPQ_YORUBA_LOWER:
    case GUIIM_M_TPQ_YORUBA_UPPER:
        is_init = QwertSmartInit(data_ptr);
        break;
    case GUIIM_M_TP_YORUBA_ABC:
    case GUIIM_M_TP_YORUBA_ABC_LEAD_UPPER:
    case GUIIM_M_TP_YORUBA_ABC_LOWER:
    case GUIIM_M_TP_YORUBA_ABC_UPPER:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_YORUBA_ABC:
    case GUIIM_M_TPQ_YORUBA_ABC_LEAD_UPPER:
    case GUIIM_M_TPQ_YORUBA_ABC_LOWER:
    case GUIIM_M_TPQ_YORUBA_ABC_UPPER:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //ZULU
#if defined (IM_ZULU_SUPPORT)
    case GUIIM_M_TP_ZULU:
    case GUIIM_M_TP_ZULU_LEAD_UPPER:
    case GUIIM_M_TP_ZULU_LOWER:
    case GUIIM_M_TP_ZULU_UPPER:
        is_init = ThumbSmartInit(data_ptr);
        break;

    case GUIIM_M_TPQ_ZULU:
    case GUIIM_M_TPQ_ZULU_LEAD_UPPER:
    case GUIIM_M_TPQ_ZULU_LOWER:
    case GUIIM_M_TPQ_ZULU_UPPER:
        is_init = QwertSmartInit(data_ptr);
        break;
    case GUIIM_M_TP_ZULU_ABC:
    case GUIIM_M_TP_ZULU_ABC_LEAD_UPPER:
    case GUIIM_M_TP_ZULU_ABC_LOWER:
    case GUIIM_M_TP_ZULU_ABC_UPPER:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_ZULU_ABC:
    case GUIIM_M_TPQ_ZULU_ABC_LEAD_UPPER:
    case GUIIM_M_TPQ_ZULU_ABC_LOWER:
    case GUIIM_M_TPQ_ZULU_ABC_UPPER:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //MYANMAR
#if defined (IM_MYANMAR_SUPPORT)
    case GUIIM_M_TP_MYANMAR_ABC:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_MYANMAR_ABC:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //AMHARIC
#if defined (IM_AMHARIC_SUPPORT) 
    case GUIIM_M_TP_AMHARIC_ABC:
        is_init = ThumbAmharicInit (data_ptr);
        break;

    case GUIIM_M_TPQ_AMHARIC_ABC:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //KHMER
#if defined (IM_KHMER_SUPPORT)
    case GUIIM_M_TP_KHMER_ABC:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_KHMER_ABC:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

        //LAO
#if defined (IM_LAO_SUPPORT)
    case GUIIM_M_TP_LAO_ABC:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_LAO_ABC:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

#if defined (IM_UYGHUR_SUPPORT)
    case GUIIM_M_TP_UYGHUR:
        is_init = ThumbSmartInit(data_ptr);
        break;

    case GUIIM_M_TPQ_UYGHUR:
        is_init = QwertSmartInit(data_ptr);
        break;
    case GUIIM_M_TP_UYGHUR_ABC:
        is_init = ThumbMultiTapInit(data_ptr);
        break;

    case GUIIM_M_TPQ_UYGHUR_ABC:
        is_init = QwertMultiTapInit(data_ptr);
        break;
#endif

#if defined(IM_TIBETAN_SUPPORT)    //tibetan 2012 0529
//	case GUIIM_M_TP_TIBETAN:
//		is_init =ThumbSmartInit(data_ptr);
//	   break;
//	case GUIIM_M_TPQ_TIBETAN:
//		is_init = QwertSmartInit(data_ptr);
//   	break;

	case GUIIM_M_TP_TIBETAN_ABC:
		is_init = ThumbMultiTapInit(data_ptr);
	   break;
	
	case GUIIM_M_TPQ_TIBETAN_ABC:
		is_init = QwertMultiTapInit( data_ptr);
		break;
#endif

        //防止有些语言忘记配置导致死机问题，如果某些语言有自己的特殊需求，请在上面配置
    default:
        {
            GUIIM_METHOD_CFG_T *method_cfg_ptr = PNULL;

            method_cfg_ptr = MMITHEME_IMGetDefByMethod(method);
            if (method_cfg_ptr)
            {
                //9键
                if (method_cfg_ptr->input == GUIIM_INPUT_TYPE_TOUCHPEN)
                {
                    //智能
                    if (method_cfg_ptr->type == GUIIM_TYPE_SMART)
                    {
                        is_init = ThumbSmartInit(data_ptr);
                    }
                    else if (method_cfg_ptr->type == GUIIM_TYPE_MULTITAP)
                    {
                        is_init = ThumbMultiTapInit(data_ptr);
                    }
                }
                //26键
                else if (method_cfg_ptr->input == GUIIM_INPUT_TYPE_TP_QWERT)
                {
                    //智能
                    if (method_cfg_ptr->type == GUIIM_TYPE_SMART)
                    {
                        is_init = QwertSmartInit(data_ptr);
                    }
                    else if (method_cfg_ptr->type == GUIIM_TYPE_MULTITAP)
                    {
                        is_init = QwertMultiTapInit(data_ptr);
                    }
                }
            }

            break;
        }
    }

    data_ptr->is_symbol_panel = FALSE;

    //输入法切换后，应该保存当前输入法语言，原因是，从输入法选择菜单中，涉及到
    //当前输入语言，需要及时更新语言
    if (MMIAPIIM_GetLanguage() != data_ptr->init_param.method_param_ptr->im_def_ptr->lang
            && GUIIM_LANG_NONE != data_ptr->init_param.method_param_ptr->im_def_ptr->lang)
    {
        MMIAPIIM_SetLanguage(data_ptr->init_param.method_param_ptr->im_def_ptr->lang);
    }

    //输入方式需要记录，防止直接切换语言，初始化的输入方式和前一次记录的输入方式不同
    //记录前一次使用的输入方式
    if(MMIAPIIM_GetLanguage() == GUIIM_LANG_ENGLISH 
        && (method != GUIIM_M_TP_123 && method != GUIIM_M_TPQ_123 && method != GUIIM_M_HANDWRITING))
    {
        g_default_en_type = data_ptr->init_param.method_param_ptr->im_def_ptr->type;
    }
    else if(MMIAPIIM_GetLanguage() != GUIIM_LANG_NONE
        && (method != GUIIM_M_TP_123 && method != GUIIM_M_TPQ_123 && method != GUIIM_M_HANDWRITING))
    {
        g_default_ch_type = data_ptr->init_param.method_param_ptr->im_def_ptr->type;
    }

    if (data_ptr->init_param.method_param_ptr->im_def_ptr->input == GUIIM_INPUT_TYPE_TOUCHPEN)
    {
        g_default_input_type = data_ptr->init_param.method_param_ptr->im_def_ptr->input;
    }

    //细节改进
    if (
		(data_ptr->init_param.method_param_ptr->im_def_ptr->input == GUIIM_INPUT_TYPE_TP_QWERT
            || data_ptr->init_param.method_param_ptr->im_def_ptr->input == GUIIM_INPUT_TYPE_TOUCHPEN)
		&& (data_ptr->init_param.method_param_ptr->im_def_ptr->type == GUIIM_TYPE_SMART
		        || data_ptr->init_param.method_param_ptr->im_def_ptr->type == GUIIM_TYPE_MULTITAP)
		)
    {
        PanelSlideCueCloseByTimer (data_ptr);
    }

    //显示问题修改，在这里修改，尽量少修改代码
    MMIIM_TOUCH_KbUnifiedCharKeysFontSize (data_ptr); 
    
    SCI_TRACE_LOW("[MMIIM] TP SetMethod: is_init=%d", is_init);    

    return is_init;
}


/*==============================================================================
Description: 重新初始化内核，因为不可预料在失去焦点之后的操作
Global resource dependence: NONE
Author: Lianxiang.Zhou
Note:
==============================================================================*/
LOCAL void ResetKernel(IM_DATA_T *data_ptr)
{
    int32 init_res = 0;
    KMX_IME_ENGINE_INIT init_info = {0};

    CHECK_DATA(data_ptr);

    if (data_ptr->is_symbol_panel)
    {
        return;
    }

    switch (data_ptr->init_param.method_param_ptr->im_def_ptr->method)
    {
#if defined(IM_HANDWRITING_HANWANG)
    case GUIIM_M_HANDWRITING:
        break;
#endif

    case GUIIM_M_TP_123:
    case GUIIM_M_TPQ_123:
        break;


    case GUIIM_M_TPQ_ENGLISH_ABC:
    case GUIIM_M_TPQ_ENGLISH_ABC_LOWER:
    case GUIIM_M_TPQ_ENGLISH_ABC_LEAD_UPPER:
    case GUIIM_M_TPQ_ENGLISH_ABC_UPPER:
        break;

    case GUIIM_M_TPQ_ENGLISH:
    case GUIIM_M_TPQ_ENGLISH_LOWER:
    case GUIIM_M_TPQ_ENGLISH_LEAD_UPPER:
    case GUIIM_M_TPQ_ENGLISH_UPPER:
        init_info.database = GetKmxLdb_ptr(GUIIM_LANG_ENGLISH, FALSE);
        MMIIM_IME_FindUserCacheByIM(
            data_ptr->init_param.method_param_ptr->im_def_ptr->method,
            &init_info.user_data, &init_info.user_data_size);
        init_res = kmx_latin_initialize(&(((KERNEL_DATA_Q_LATIN_T*)(data_ptr->data))->engine), &init_info);
        MMIIM_SetImKerState(0);
        break;

    case GUIIM_M_TP_ENGLISH_ABC:
    case GUIIM_M_TP_ENGLISH_ABC_LOWER:
    case GUIIM_M_TP_ENGLISH_ABC_LEAD_UPPER:
    case GUIIM_M_TP_ENGLISH_ABC_UPPER:
        break;

    case GUIIM_M_TP_ENGLISH:
    case GUIIM_M_TP_ENGLISH_LOWER:
    case GUIIM_M_TP_ENGLISH_LEAD_UPPER:
    case GUIIM_M_TP_ENGLISH_UPPER:
        init_info.database = GetKmxLdb_ptr(GUIIM_LANG_ENGLISH, FALSE);        
        MMIIM_IME_FindUserCacheByIM(
            data_ptr->init_param.method_param_ptr->im_def_ptr->method,
            &init_info.user_data, &init_info.user_data_size);
        init_res = kmx_latin_initialize(&(((KERNEL_DATA_LATIN_T*)(data_ptr->data))->engine), &init_info);
        MMIIM_SetImKerState(0);
        break;

#if defined (IM_SIMP_CHINESE_SUPPORT)
    case GUIIM_M_TP_PINYIN:
        init_info.database = GetKmxLdb_ptr(GUIIM_LANG_CHS, FALSE);
        init_info.flags = GetPyFuzzy();
        MMIIM_IME_FindUserCacheByIM(
            data_ptr->init_param.method_param_ptr->im_def_ptr->method,
            &init_info.user_data, &init_info.user_data_size);
        init_res = kmx_pinyin_initialize(&(((KERNEL_DATA_PINYIN_T*)(data_ptr->data))->engine), &init_info);
        MMIIM_SetImKerState(0);
        break;

    case GUIIM_M_TPQ_PINYIN:
        init_info.database = GetKmxLdb_ptr(GUIIM_LANG_CHS, FALSE);
        init_info.flags = GetPyFuzzy();
        MMIIM_IME_FindUserCacheByIM(
            data_ptr->init_param.method_param_ptr->im_def_ptr->method,
            &init_info.user_data, &init_info.user_data_size);
        init_res = kmx_pinyin_initialize(&(((KERNEL_DATA_Q_PINYIN_T*)(data_ptr->data))->engine), &init_info);
        MMIIM_SetImKerState(0);
        break;

    case GUIIM_M_TP_STROKE:
    case GUIIM_M_TPQ_STROKE:
        init_info.database = GetKmxLdb_ptr(GUIIM_LANG_CHS, TRUE);
        MMIIM_IME_FindUserCacheByIM(
            data_ptr->init_param.method_param_ptr->im_def_ptr->method,
            &init_info.user_data, &init_info.user_data_size);
        init_res = kmx_stroke_initialize(&(((KERNEL_DATA_STROKE_T*)(data_ptr->data))->engine), &init_info);
        MMIIM_SetImKerState(0);
        break;
#endif

#if defined (IM_TRAD_CHINESE_SUPPORT)
    case GUIIM_M_TP_ZHUYIN:
        init_info.database = GetKmxLdb_ptr(GUIIM_LANG_CHT, FALSE);
        MMIIM_IME_FindUserCacheByIM(
            data_ptr->init_param.method_param_ptr->im_def_ptr->method,
            &init_info.user_data, &init_info.user_data_size);
        init_res = kmx_zhuyin_initialize(&(((KERNEL_DATA_ZHUYIN_T *)(data_ptr->data))->engine), &init_info);
        MMIIM_SetImKerState(0);
        break;

    case GUIIM_M_TPQ_ZHUYIN:
        init_info.database = GetKmxLdb_ptr(GUIIM_LANG_CHT, FALSE);
        MMIIM_IME_FindUserCacheByIM(
            data_ptr->init_param.method_param_ptr->im_def_ptr->method,
            &init_info.user_data, &init_info.user_data_size);
        init_res = kmx_zhuyin_initialize(&(((KERNEL_DATA_Q_ZHUYIN_T *)(data_ptr->data))->engine), &init_info);
        MMIIM_SetImKerState(0);
        break;

    case GUIIM_M_TP_STROKE_CHT:
    case GUIIM_M_TPQ_STROKE_CHT:
        init_info.database = GetKmxLdb_ptr(GUIIM_LANG_CHT, TRUE);
        MMIIM_IME_FindUserCacheByIM(
            data_ptr->init_param.method_param_ptr->im_def_ptr->method,
            &init_info.user_data, &init_info.user_data_size);
        init_res = kmx_stroke_initialize(&(((KERNEL_DATA_STROKE_T*)(data_ptr->data))->engine), &init_info);
        MMIIM_SetImKerState(0);
        break;
#endif

//孟加拉语multi-tap是一个例外
#if defined (IM_BENGALI_SUPPORT)
	case GUIIM_M_TP_BENGALI_ABC:
	case GUIIM_M_TPQ_BENGALI_ABC:
        init_info.database = GetKmxLdb_ptr(GUIIM_LANG_BENGALI, FALSE);        
        MMIIM_IME_FindUserCacheByIM(
            data_ptr->init_param.method_param_ptr->im_def_ptr->method,
            &init_info.user_data, &init_info.user_data_size);
        init_res = kmx_latin_initialize(&(((KERNEL_DATA_LATIN_T*)(data_ptr->data))->engine), &init_info);
        MMIIM_SetImKerState(0);
		break;		
#endif

    default:
        if (data_ptr->init_param.method_param_ptr->im_def_ptr->type == GUIIM_TYPE_SMART)
        {
            init_info.database = GetKmxLdb_ptr(data_ptr->init_param.method_param_ptr->im_def_ptr->lang, FALSE);
            MMIIM_IME_FindUserCacheByIM(
                data_ptr->init_param.method_param_ptr->im_def_ptr->method,
                &init_info.user_data, &init_info.user_data_size);
            if (GUIIM_INPUT_TYPE_TOUCHPEN == data_ptr->init_param.method_param_ptr->im_def_ptr->input)
            {
                init_res = kmx_latin_initialize(&(((KERNEL_DATA_LATIN_T*)(data_ptr->data))->engine), &init_info);
                MMIIM_SetImKerState(0);
            }
            else if (GUIIM_INPUT_TYPE_TP_QWERT == data_ptr->init_param.method_param_ptr->im_def_ptr->input)
            {
                init_res = kmx_latin_initialize(&(((KERNEL_DATA_Q_LATIN_T*)(data_ptr->data))->engine), &init_info);
                MMIIM_SetImKerState(0);
            }
        }
        break;
    }    

    return;
}

/*==============================================================================
Description: IsInputting
Global resource dependence: NONE
Author: Lianxiang.Zhou
Note:
==============================================================================*/
LOCAL BOOLEAN IsInputting(IM_DATA_T *data_ptr)
{
    BOOLEAN is_inputting = FALSE;

    CHECK_DATA_EX(data_ptr);

    if (data_ptr->is_symbol_panel)
    {
        return FALSE;
    }

    switch (data_ptr->init_param.method_param_ptr->im_def_ptr->method)
    {
#if defined(IM_HANDWRITING_HANWANG)
    case GUIIM_M_HANDWRITING:
        is_inputting = (((KERNEL_DATA_HW_T*)(data_ptr->data))->cand_cnt > 0 || ((KERNEL_DATA_HW_T*)(data_ptr->data))->trace_len > 0);
        break;
#endif

    case GUIIM_M_TP_123:
    case GUIIM_M_TPQ_123:
        break;

#if defined (IM_SIMP_CHINESE_SUPPORT)
    case GUIIM_M_TP_PINYIN:
        is_inputting = (((KERNEL_DATA_PINYIN_T*)(data_ptr->data))->cand_cnt > 0);
        break;
        
    case GUIIM_M_TPQ_PINYIN:
        is_inputting = (((KERNEL_DATA_Q_PINYIN_T*)(data_ptr->data))->cand_cnt > 0);
        break;

    case GUIIM_M_TP_STROKE:
    case GUIIM_M_TPQ_STROKE:
        is_inputting = (((KERNEL_DATA_STROKE_T*)(data_ptr->data))->cand_cnt > 0);
        break;
#endif

//繁体中文
#if defined (IM_TRAD_CHINESE_SUPPORT)
    case GUIIM_M_TP_ZHUYIN:
        is_inputting = (((KERNEL_DATA_ZHUYIN_T *)(data_ptr->data))->cand_cnt > 0);
        break;

    case GUIIM_M_TPQ_ZHUYIN:
        is_inputting = (((KERNEL_DATA_Q_ZHUYIN_T *)(data_ptr->data))->cand_cnt > 0);
        break;

    case GUIIM_M_TP_STROKE_CHT:
    case GUIIM_M_TPQ_STROKE_CHT:
        is_inputting = (((KERNEL_DATA_STROKE_T*)(data_ptr->data))->cand_cnt > 0);
        break;
#endif

//BENGALI
#if defined (IM_BENGALI_SUPPORT)
    case GUIIM_M_TP_BENGALI:
        is_inputting = (((KERNEL_DATA_LATIN_T*)(data_ptr->data))->cand_cnt > 0);
        break;

    case GUIIM_M_TPQ_BENGALI:
        is_inputting = (((KERNEL_DATA_Q_LATIN_T*)(data_ptr->data))->cand_cnt > 0);
        break;
		
    case GUIIM_M_TP_BENGALI_ABC:
        break;

    case GUIIM_M_TPQ_BENGALI_ABC:
        break;
#endif

    default:		//绝大部分Latin库程序走这里，个别特殊的输入法在前面的case中添加
		{
            GUIIM_METHOD_CFG_T *method_cfg_ptr = PNULL;
            
            method_cfg_ptr = MMITHEME_IMGetDefByMethod(data_ptr->init_param.method_param_ptr->im_def_ptr->method);
            if(method_cfg_ptr)
            {
                //9键	智能
                if (method_cfg_ptr->input == GUIIM_INPUT_TYPE_TOUCHPEN && method_cfg_ptr->type == GUIIM_TYPE_SMART)
                {
                    is_inputting = (((KERNEL_DATA_LATIN_T*)(data_ptr->data))->cand_cnt > 0);
                }
                //26键	智能
                else if (method_cfg_ptr->input == GUIIM_INPUT_TYPE_TP_QWERT && method_cfg_ptr->type == GUIIM_TYPE_SMART)
                {
                    is_inputting = (((KERNEL_DATA_Q_LATIN_T*)(data_ptr->data))->cand_cnt > 0);
                }
            }
            else
            {
                SCI_TRACE_LOW("[MMIIM] IsInputting: default unreason switch.");
            }
        }

        break;
    }

    return is_inputting;
}


#else
//define a fake api list...
GUIIM_KERNEL_APIS_T const g_guiim_touch_apis = {0};
#endif



/*Edit by script, ignore 4 case. Thu Apr 26 19:00:56 2012*/ //IGNORE9527
